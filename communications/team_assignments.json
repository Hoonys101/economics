{
  "antigravity": {
    "project": "economics",
    "active_sessions": {
      "5549135717124718802": {
        "title": "TD-067 Phase B/C: Firm Facade Deconstruction",
        "initial_mission": "Refactor Firm class to remove 20+ wrapper properties and encapsulate CorporateManager interactions."
      },
      "8108259102747887077": {
        "title": "TD-067 Phase B/C: Firm Facade Deconstruction",
        "initial_mission": "# TD-067 Phase B/C: Firm Facade Deconstruction\n\n## Context\nYou are continuing the TD-067 refactoring work. **Phase A (FinanceDepartment Extraction) has been successfully merged**. Your task is to complete **Phase B (Remove Wrapper Properties)** and **Phase C (Reduce CorporateManager Coupling)**.\n\n## Critical Instructions\n\n### âš ï¸ SoC Preservation (MANDATORY)\n**DO NOT regress to God Class pattern.** The codebase has undergone extensive SoC refactoring:\n- `Simulation` â†’ `WorldState`, `TickScheduler`, `ActionProcessor` (TD-066)\n- `Household` â†’ `BioComponent`, `EconComponent`, `SocialComponent` (TD-065)\n- `Firm` â†’ `HRDepartment`, `FinanceDepartment`, `ProductionDepartment`, `SalesDepartment` (TD-067 Phase A)\n\n**You MUST maintain this architecture.** Do not create wrapper properties or consolidate logic back into `Firm`.\n\n### ðŸ“‹ Pre-Merge Checklist (You MUST confirm in PR description)\n- [ ] Zero `@property` wrappers in `Firm` class\n- [ ] All `CorporateManager` methods use encapsulation APIs\n- [ ] `tests/test_corporate_manager.py` passes\n- [ ] `tests/verification/verify_mitosis.py` passes (Golden Fixture compatibility)\n- [ ] No direct `firm.assets` access outside `FinanceDepartment`\n\n---\n\n## Task Specification\n\nRead the full specification at: `design/specs/TD-067_Phase_BC_Firm_Refactor_Spec.md`\n\n### Summary of Work\n\n#### Track B: Eliminate Wrapper Properties\n1. Remove **all 20+ `@property` wrappers** from `simulation/firms.py` (lines 181-299)\n2. Move logic to components:\n   - `calculate_valuation()` â†’ `FinanceDepartment`\n   - `get_book_value_per_share()` â†’ `FinanceDepartment`\n   - `get_financial_snapshot()` â†’ `FinanceDepartment`\n\n#### Track C: Reduce CorporateManager Coupling\n1. Add encapsulation methods to `FinanceDepartment`:\n   - `invest_in_automation(amount: float) -> bool`\n   - `invest_in_rd(amount: float) -> bool`\n   - `invest_in_capex(amount: float) -> bool`\n   - `set_dividend_rate(rate: float) -> None`\n\n2. Refactor `simulation/decisions/corporate_manager.py`:\n   - Replace `firm.assets -= budget` â†’ `firm.finance.invest_in_automation(budget)`\n   - Replace `firm.dividend_rate = x` â†’ `firm.finance.set_dividend_rate(x)`\n   - Update methods: `_manage_automation`, `_manage_r_and_d`, `_manage_capex`, `_manage_dividends`, `_manage_hiring`\n\n#### Track D: Refactor All Call Sites\n1. Update `tests/test_corporate_manager.py`:\n   - Mock sub-components: `firm_mock.finance.assets = 10000.0`\n   - Update assertions: `assert firm_mock.finance.assets == expected`\n\n2. Update `tests/test_firms.py`:\n   - Call `firm.finance.get_book_value_per_share()` instead of `firm.get_book_value_per_share()`\n\n3. Update `Firm` internal methods:\n   - `make_decision()`, `get_agent_data()`, `update_needs()` â†’ access sub-components directly\n\n---\n\n## Verification Requirements\n\n### Must Pass\n- `pytest tests/test_corporate_manager.py` âœ…\n- `pytest tests/test_firms.py` âœ…\n- `pytest tests/verification/verify_mitosis.py` âœ… (Golden Fixture gate check)\n- `ruff check simulation/` (no unused imports)\n\n### Manual Checks\n- Grep for `firm.assets` outside `FinanceDepartment` â†’ should return 0 results (except in tests)\n- Grep for `@property` in `Firm` class â†’ should return 0 results\n\n---\n\n## Reference Documents\n- **Spec**: `design/specs/TD-067_Phase_BC_Firm_Refactor_Spec.md` (FULL DETAILS)\n- **Template**: `design/specs/TD-065_Household_Refactor_Spec.md` (Similar refactoring pattern)\n- **Handover Warning**: `design/handovers/HANDOVER_2026-01-20.md` (Jules regression alert)\n- **Tech Debt**: `design/TECH_DEBT_LEDGER.md` (TD-067 entry)\n\n---\n\n## Success Criteria\nâœ… All wrapper properties removed\nâœ… `CorporateManager` uses encapsulation methods only\nâœ… All tests pass (including Golden Fixtures)\nâœ… No God Class regression (verified by code review)\nâœ… Pre-merge checklist confirmed in PR description\n"
      },
      "1168830734155576498": {
        "title": "Infra-Cleanup: TD-050, TD-063, TD-051 Stabilization",
        "initial_mission": "# Mission: Infrastructure & Script Maintenance (TD-050, TD-063, TD-051)\n\n## Context\nAs the project grows, our utility scripts and documentation need stabilization. You are assigned to clean up import logic, exclude noise from health reports, and finalize documentation IDs.\n\n## Task Details\n\n### 1. Stable Import Logic (TD-063)\n- **Problem**: Many scripts in `scripts/` use `sys.path.append(os.path.join(os.path.dirname(__file__), '..'))` which is brittle and can fail depending on execution context.\n- **Action**: Refactor all scripts in `scripts/` to use `pathlib` for project root detection.\n- **Goal**: Ensure consistent behavior when run from any directory.\n\n### 2. Cleanup Health Reports (TD-050)\n- **Problem**: `scripts/scan_codebase.py` (or similar audit scripts) scans `scripts/observer/`, leading to false positive complexity alerts in third-party or observer-only code.\n- **Action**: Update the scanning logic to exclude the `scripts/observer/` and `design/` (artifacts) directories from the complexity/SoC analysis.\n\n### 3. Documentation Sanitization (TD-051)\n- **Problem**: Some manuals or specs still contain `WO-XXX` placeholders instead of concrete task IDs.\n- **Action**: Grep for any remaining `WO-XXX` in the `design/` folder and replace them with the actual Work Order IDs (e.g., `WO-083C`) based on the contents of the file or `TECH_DEBT_LEDGER.md`.\n\n## Verification Requirements\n- All refactored scripts must still run correctly (e.g., `python scripts/launcher.py --help`).\n- Run the health scan script and verify `scripts/observer` is no longer in the report.\n- `grep -r \"WO-XXX\" design/` should return zero results.\n\n## Success Criteria\n- âœ… Import logic homogenized using `pathlib`.\n- âœ… Health reports are noise-free.\n- âœ… Documentation is free of placeholders.\n"
      },
      "7846289173909215125": {
        "title": "Finance Config Migration: TD-034, TD-041",
        "initial_mission": "# Mission: Finance Parameter Migration (TD-034, TD-041)\n\n## Context\nWe are moving away from hardcoded economic constants to a fully configurable simulation. Your task is to extract hidden financial parameters into the `config/` system.\n\n## Task Details\n\n### 1. Hardcoded Debt Parameters (TD-034)\n- **Problem**: Bond maturity lengths, risk premia, and debt ceilings are hardcoded in `simulation/agents/government.py` or finance modules.\n- **Action**: \n    - Identify these constants.\n    - Add them to the global config (e.g., `config/economy_params.yaml`).\n    - Update the code to read these via `ConfigManager`.\n\n### 2. Bailout Covenant Ratio (TD-041)\n- **Problem**: The repayment ratio of 0.5 for corporate bailouts is hardcoded.\n- **Action**: \n    - Move `BAILOUT_COVENANT_RATIO` to the configuration system.\n    - Default remains `0.5`, but it must be adjustable without code changes.\n\n## Verification Requirements\n- The simulation must run (`python main.py --ticks 10`) without any change in behavior using default config values.\n- Verify that changing these values in the config file actually affects the simulation (e.g., shorter bond maturity).\n\n## Success Criteria\n- âœ… No hardcoded debt constants in logic files.\n- âœ… Corporate bailout terms are fully configurable.\n"
      }
    },
    "completed_sessions": {
      "9966767717181422022": "TD-067-Phase-A: Firm Logic Consolidation - MERGED 2026-01-20",
      "18090137123816755263": "WO-083C-P3-REWORK: Fix Regression & Migrate Test - MERGED 2026-01-20",
      "16457788477972542743": "TD-065 Household God Class Refactoring - COMPLETED 2026-01-20",
      "13554214772414011208": "TD-066 Simulation God Class Refactor - COMPLETED 2026-01-20",
      "1212660192877761122": "WO-083C P1 Low Risk Migration - COMPLETED 2026-01-20",
      "13794252736923687768": "WO-083C P2 Medium Risk Migration - COMPLETED 2026-01-20",
      "11016259656214972314": "WO-083C P3 High Risk Migration (Old) - REJECTED 2026-01-20",
      "6980280111914954682": "WO-083C P3 High Risk Migration (Incomplete) - ARCHIVED 2026-01-20",
      "3970950953200710533": "TD-067 Phase A Initial Attempt - ARCHIVED 2026-01-20",
      "8111922141870240162": "WO-083C-P1: Test Migration (LOW Risk) - MERGED 2026-01-20",
      "11202564815416347618": "WO-083C-P2: Test Migration (MEDIUM Risk) - MERGED 2026-01-20",
      "9067551690220486700": "WO-083C-P3: Test Migration (HIGH Risk) - MERGED 2026-01-20",
      "6338045545797855725": "WO-083A: Golden Fixture Generation - MERGED 2026-01-20",
      "11560612815746517359": "WO-083A: Golden Fixture Generation - MERGED 2026-01-20",
      "1503508227423661963": "WO-083B: Test Migration Phase 1 - MERGED 2026-01-20",
      "16754935071282510850": "WO-081: Bank Interface Segregation - MERGED 2026-01-19",
      "15965755950889487504": "WO-082: Golden Loader Infrastructure - MERGED 2026-01-19",
      "17536225839445736015": "Phase-29_The_Depression - COMPLETED 2026-01-19",
      "5597989927571483094": "TD-043/044/045 God Class Refactoring - MERGED 2026-01-18",
      "14826170066369985962": "TD-008 Finance Upgrade - MERGED 2026-01-16",
      "2244231495852370011": "WO-079 Config Automation v2 - MERGED 2026-01-16",
      "12543922642187456551": "TD-045 Firm God Class - COMPLETED 2026-01-16",
      "4889257989211040620": "TD-044 Household God Class - COMPLETED 2026-01-16",
      "5283327958326335498": "TD-024 Post-Fix Test - COMPLETED 2026-01-16",
      "8465436477342866436": "WO-037 Simulation Cockpit - MERGED 2026-01-16",
      "15007179683109829611": "WO-060 - MERGED 2026-01-15",
      "7095675393629273222": "WO-064: Banking Credit Engine - MERGED 2026-01-15",
      "10296031762289509515": "WO-065: Monetary Integrity & Suture - MERGED 2026-01-15",
      "14018014647659914271": "WO-062: Macro-Linked Portfolio - MERGED 2026-01-15",
      "9343683714945509652": "WO-066: High-Fidelity Sensory Architecture - MERGED 2026-01-15",
      "9719318674264407147": "WO-067: High-Fidelity Reaction Test - MERGED 2026-01-15",
      "3778947626343557354": "WO-057-Refine Shock Therapy (Retry) - MERGED 2026-01-14",
      "11626928342509996952": "TD-014: Government SoC Refactoring - MERGED 2026-01-14",
      "10078451815509526740": "WO-058-Retry: Operation Defibrillator - MERGED 2026-01-14",
      "4444007150223365139": "WO-058 Economic CPR - MERGED 2026-01-14"
    }
  }
}