{
  "antigravity": {
    "project": "economics",
    "active_sessions": {
      "16754935071282510850": {
        "title": "WO-081: Bank Interface Segregation",
        "initial_mission": "# WO-081: Bank Interface Segregation & Refactoring\n\n## üéØ Objective\n`Bank` ÌÅ¥ÎûòÏä§Ïùò Ïù∏ÌÑ∞ÌéòÏù¥Ïä§Î•º Î¶¨Ìå©ÌÜ†ÎßÅÌïòÏó¨, **Í≥†Í∞ù ÏÑúÎπÑÏä§(Agent Service)**ÏôÄ **Í∏àÏúµ ÏóîÌã∞Ìã∞(Financial Entity)**Î°úÏÑúÏùò Ïó≠Ìï†ÏùÑ Î™ÖÌôïÌûà Î∂ÑÎ¶¨Ìï©ÎãàÎã§. Ïù¥Î•º ÌÜµÌï¥ ÌÜµÌï© ÌÖåÏä§Ìä∏ Ïãú Î∞úÏÉùÌïòÎäî `TypeError`ÏôÄ Í∏àÏúµ ÏãúÏä§ÌÖú Ïó∞Îèô Ïò§Î•òÎ•º Í∑ºÎ≥∏Ï†ÅÏúºÎ°ú Ìï¥Í≤∞Ìï©ÎãàÎã§.\n\n> **Warning**: Do NOT implement \"data saving\" or \"fixtures\" in this task. Focus ONLY on the code refactoring.\n\n---\n\n## üî® Tasks\n\n### 1. Interface Definition\n`Bank` ÌÅ¥ÎûòÏä§Îäî Îëê Í∞ÄÏßÄ Ïó≠Ìï†ÏùÑ Î™ÖÌôïÌûà Íµ¨Î∂ÑÌï¥Ïïº Ìï©ÎãàÎã§.\n\n1. **`IBankService` (For Core Agents: Household, Firm)**\n   - Methods:\n     - `deposit_from_customer(agent_id: int, amount: float) -> str`\n       - Returns `deposit_id`.\n       - Replaces usage of `deposit(agent_id, amount)`.\n     - `withdraw_for_customer(agent_id: int, amount: float) -> bool`\n       - Returns `success`.\n       - Replaces usage of `withdraw(agent_id, amount)`.\n\n2. **`IFinancialEntity` (For Finance System: CentralBank, Treasury)**\n   - Inherits from `modules.finance.interfaces.IFinancialEntity`.\n   - Methods:\n     - `deposit(amount: float) -> None`\n       - Increases Bank's **Reserve/Equity** (not customer deposits).\n     - `withdraw(amount: float) -> None`\n       - Decreases Bank's **Reserve/Equity**.\n       - Must raise `InsufficientFundsError` if insufficient.\n\n### 2. Bank Class Refactoring (`simulation/bank.py`)\n- Rename current `deposit` methods to `deposit_from_customer`.\n- Rename current `withdraw` methods to `withdraw_for_customer`.\n- Implement strict `IFinancialEntity` methods.\n- **Strictly Avoid**: Do NOT use `*args` or `len(args)` checks. Use explicit method names.\n\n### 3. Usage Update (Global Search & Replace)\nYou must update all call sites that use the old methods.\n\n- **`simulation/loan_market.py`**:\n  - `bank.deposit(..., ...)` -> `bank.deposit_from_customer(..., ...)`\n  - `bank.withdraw(..., ...)` -> `bank.withdraw_for_customer(..., ...)`\n- **`simulation/agents/government.py`** (if applicable):\n  - Check bailouts logic. If it injects capital, it should use `IFinancialEntity.deposit(amount)`.\n- **Tests**:\n  - Update `tests/test_bank.py` and other tests to use new method names.\n\n---\n\n## ‚úÖ Acceptance Criteria\n\n1. [ ] `Bank` class implements `IFinancialEntity` without conflicting with customer methods.\n2. [ ] No usage of `*args` or dynamic dispatch based on argument count in `Bank`.\n3. [ ] All tests passing (especially `test_bank.py` and `test_system.py`).\n4. [ ] Zero-Sum principle requires that `IFinancialEntity.deposit/withdraw` affect `self.assets` directly.\n\n---\n\n## ‚ö†Ô∏è Constraints\n- **Zero-Sum**: When implementing `withdraw_for_customer`, ensure asset transfer logic remains correct (currently handled via `Transaction` in LoanMarket, so Bank just updates internal ledger).\n- **Scope**: Do NOT fix `FixtureHarvester` or create golden files in this session. Focus on the class API.\n"
      }
    },
    "completed_sessions": {
      "17536225839445736015": "Phase-29_The_Great_Depression - COMPLETED 2026-01-19",
      "5597989927571483094": "TD-043/044/045 God Class Refactoring - MERGED 2026-01-18",
      "14826170066369985962": "TD-008 Finance Upgrade - MERGED 2026-01-16",
      "2244231495852370011": "WO-079 Config Automation v2 - MERGED 2026-01-16",
      "12543922642187456551": "TD-045 Firm God Class - COMPLETED 2026-01-16",
      "4889257989211040620": "TD-044 Household God Class - COMPLETED 2026-01-16",
      "5283327958326335498": "TD-024 Post-Fix Test - COMPLETED 2026-01-16",
      "8465436477342866436": "WO-037 Simulation Cockpit - MERGED 2026-01-16",
      "15007179683109829611": "WO-060 - MERGED 2026-01-15",
      "7095675393629273222": "WO-064: Banking Credit Engine - MERGED 2026-01-15",
      "10296031762289509515": "WO-065: Monetary Integrity & Suture - MERGED 2026-01-15",
      "14018014647659914271": "WO-062: Macro-Linked Portfolio - MERGED 2026-01-15",
      "9343683714945509652": "WO-066: High-Fidelity Sensory Architecture - MERGED 2026-01-15",
      "9719318674264407147": "WO-067: High-Fidelity Reaction Test - MERGED 2026-01-15",
      "3778947626343557354": "WO-057-Refine Shock Therapy (Retry) - MERGED 2026-01-14",
      "11626928342509996952": "TD-014: Government SoC Refactoring - MERGED 2026-01-14",
      "10078451815509526740": "WO-058-Retry: Operation Defibrillator - MERGED 2026-01-14",
      "4444007150223365139": "WO-058 Economic CPR - MERGED 2026-01-14"
    }
  }
}