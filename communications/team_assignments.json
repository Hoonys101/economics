{
  "antigravity": {
    "project": "economics",
    "active_sessions": {
      "5549135717124718802": {
        "title": "TD-067 Phase B/C: Firm Facade Deconstruction",
        "initial_mission": "Refactor Firm class to remove 20+ wrapper properties and encapsulate CorporateManager interactions."
      },
      "8108259102747887077": {
        "title": "TD-067 Phase B/C: Firm Facade Deconstruction",
        "initial_mission": "# TD-067 Phase B/C: Firm Facade Deconstruction\n\n## Context\nYou are continuing the TD-067 refactoring work. **Phase A (FinanceDepartment Extraction) has been successfully merged**. Your task is to complete **Phase B (Remove Wrapper Properties)** and **Phase C (Reduce CorporateManager Coupling)**.\n\n## Critical Instructions\n\n### ‚ö†Ô∏è SoC Preservation (MANDATORY)\n**DO NOT regress to God Class pattern.** The codebase has undergone extensive SoC refactoring:\n- `Simulation` ‚Üí `WorldState`, `TickScheduler`, `ActionProcessor` (TD-066)\n- `Household` ‚Üí `BioComponent`, `EconComponent`, `SocialComponent` (TD-065)\n- `Firm` ‚Üí `HRDepartment`, `FinanceDepartment`, `ProductionDepartment`, `SalesDepartment` (TD-067 Phase A)\n\n**You MUST maintain this architecture.** Do not create wrapper properties or consolidate logic back into `Firm`.\n\n### üìã Pre-Merge Checklist (You MUST confirm in PR description)\n- [ ] Zero `@property` wrappers in `Firm` class\n- [ ] All `CorporateManager` methods use encapsulation APIs\n- [ ] `tests/test_corporate_manager.py` passes\n- [ ] `tests/verification/verify_mitosis.py` passes (Golden Fixture compatibility)\n- [ ] No direct `firm.assets` access outside `FinanceDepartment`\n\n---\n\n## Task Specification\n\nRead the full specification at: `design/specs/TD-067_Phase_BC_Firm_Refactor_Spec.md`\n\n### Summary of Work\n\n#### Track B: Eliminate Wrapper Properties\n1. Remove **all 20+ `@property` wrappers** from `simulation/firms.py` (lines 181-299)\n2. Move logic to components:\n   - `calculate_valuation()` ‚Üí `FinanceDepartment`\n   - `get_book_value_per_share()` ‚Üí `FinanceDepartment`\n   - `get_financial_snapshot()` ‚Üí `FinanceDepartment`\n\n#### Track C: Reduce CorporateManager Coupling\n1. Add encapsulation methods to `FinanceDepartment`:\n   - `invest_in_automation(amount: float) -> bool`\n   - `invest_in_rd(amount: float) -> bool`\n   - `invest_in_capex(amount: float) -> bool`\n   - `set_dividend_rate(rate: float) -> None`\n\n2. Refactor `simulation/decisions/corporate_manager.py`:\n   - Replace `firm.assets -= budget` ‚Üí `firm.finance.invest_in_automation(budget)`\n   - Replace `firm.dividend_rate = x` ‚Üí `firm.finance.set_dividend_rate(x)`\n   - Update methods: `_manage_automation`, `_manage_r_and_d`, `_manage_capex`, `_manage_dividends`, `_manage_hiring`\n\n#### Track D: Refactor All Call Sites\n1. Update `tests/test_corporate_manager.py`:\n   - Mock sub-components: `firm_mock.finance.assets = 10000.0`\n   - Update assertions: `assert firm_mock.finance.assets == expected`\n\n2. Update `tests/test_firms.py`:\n   - Call `firm.finance.get_book_value_per_share()` instead of `firm.get_book_value_per_share()`\n\n3. Update `Firm` internal methods:\n   - `make_decision()`, `get_agent_data()`, `update_needs()` ‚Üí access sub-components directly\n\n---\n\n## Verification Requirements\n\n### Must Pass\n- `pytest tests/test_corporate_manager.py` ‚úÖ\n- `pytest tests/test_firms.py` ‚úÖ\n- `pytest tests/verification/verify_mitosis.py` ‚úÖ (Golden Fixture gate check)\n- `ruff check simulation/` (no unused imports)\n\n### Manual Checks\n- Grep for `firm.assets` outside `FinanceDepartment` ‚Üí should return 0 results (except in tests)\n- Grep for `@property` in `Firm` class ‚Üí should return 0 results\n\n---\n\n## Reference Documents\n- **Spec**: `design/specs/TD-067_Phase_BC_Firm_Refactor_Spec.md` (FULL DETAILS)\n- **Template**: `design/specs/TD-065_Household_Refactor_Spec.md` (Similar refactoring pattern)\n- **Handover Warning**: `design/handovers/HANDOVER_2026-01-20.md` (Jules regression alert)\n- **Tech Debt**: `design/TECH_DEBT_LEDGER.md` (TD-067 entry)\n\n---\n\n## Success Criteria\n‚úÖ All wrapper properties removed\n‚úÖ `CorporateManager` uses encapsulation methods only\n‚úÖ All tests pass (including Golden Fixtures)\n‚úÖ No God Class regression (verified by code review)\n‚úÖ Pre-merge checklist confirmed in PR description\n"
      },
      "1168830734155576498": {
        "title": "Infra-Cleanup: TD-050, TD-063, TD-051 Stabilization",
        "initial_mission": "# Mission: Infrastructure & Script Maintenance (TD-050, TD-063, TD-051)\n\n## Context\nAs the project grows, our utility scripts and documentation need stabilization. You are assigned to clean up import logic, exclude noise from health reports, and finalize documentation IDs.\n\n## Task Details\n\n### 1. Stable Import Logic (TD-063)\n- **Problem**: Many scripts in `scripts/` use `sys.path.append(os.path.join(os.path.dirname(__file__), '..'))` which is brittle and can fail depending on execution context.\n- **Action**: Refactor all scripts in `scripts/` to use `pathlib` for project root detection.\n- **Goal**: Ensure consistent behavior when run from any directory.\n\n### 2. Cleanup Health Reports (TD-050)\n- **Problem**: `scripts/scan_codebase.py` (or similar audit scripts) scans `scripts/observer/`, leading to false positive complexity alerts in third-party or observer-only code.\n- **Action**: Update the scanning logic to exclude the `scripts/observer/` and `design/` (artifacts) directories from the complexity/SoC analysis.\n\n### 3. Documentation Sanitization (TD-051)\n- **Problem**: Some manuals or specs still contain `WO-XXX` placeholders instead of concrete task IDs.\n- **Action**: Grep for any remaining `WO-XXX` in the `design/` folder and replace them with the actual Work Order IDs (e.g., `WO-083C`) based on the contents of the file or `TECH_DEBT_LEDGER.md`.\n\n## Verification Requirements\n- All refactored scripts must still run correctly (e.g., `python scripts/launcher.py --help`).\n- Run the health scan script and verify `scripts/observer` is no longer in the report.\n- `grep -r \"WO-XXX\" design/` should return zero results.\n\n## Success Criteria\n- ‚úÖ Import logic homogenized using `pathlib`.\n- ‚úÖ Health reports are noise-free.\n- ‚úÖ Documentation is free of placeholders.\n"
      },
      "7846289173909215125": {
        "title": "Finance Config Migration: TD-034, TD-041",
        "initial_mission": "# Mission: Finance Parameter Migration (TD-034, TD-041)\n\n## Context\nWe are moving away from hardcoded economic constants to a fully configurable simulation. Your task is to extract hidden financial parameters into the `config/` system.\n\n## Task Details\n\n### 1. Hardcoded Debt Parameters (TD-034)\n- **Problem**: Bond maturity lengths, risk premia, and debt ceilings are hardcoded in `simulation/agents/government.py` or finance modules.\n- **Action**: \n    - Identify these constants.\n    - Add them to the global config (e.g., `config/economy_params.yaml`).\n    - Update the code to read these via `ConfigManager`.\n\n### 2. Bailout Covenant Ratio (TD-041)\n- **Problem**: The repayment ratio of 0.5 for corporate bailouts is hardcoded.\n- **Action**: \n    - Move `BAILOUT_COVENANT_RATIO` to the configuration system.\n    - Default remains `0.5`, but it must be adjustable without code changes.\n\n## Verification Requirements\n- The simulation must run (`python main.py --ticks 10`) without any change in behavior using default config values.\n- Verify that changing these values in the config file actually affects the simulation (e.g., shorter bond maturity).\n\n## Success Criteria\n- ‚úÖ No hardcoded debt constants in logic files.\n- ‚úÖ Corporate bailout terms are fully configurable.\n"
      },
      "9460236520355501841": {
        "title": "Domain-Logic-Refactor: TD-059 Solvency Delegation",
        "initial_mission": "# Mission Brief: Domain Logic Refactor (Solvency Calculation)\n\n**TO:** Jules\n**FROM:** Antigravity (via Gemini Scribe)\n**SUBJECT:** Refactor `FinanceDepartment` to Delegate Solvency Logic\n**TRACKING ID:** `WO-084` (Work Order)\n**RELATED DEBT:** `TD-059`, `TD-058`\n\n---\n\n## 1. Objective\n\nRefactor the `FinanceDepartment` component to eliminate its internal `calculate_altman_z_score` method. All solvency calculations must be delegated to a dedicated, pure `AltmanZScoreCalculator` component, adhering to our established DTO-based communication protocol. This action will resolve technical debt `TD-059` and enforce the Single Source of Truth (SSOT) principle for financial analytics.\n\n## 2. Context & Architectural Mandate\n\nThe recent pre-flight audit confirmed that `FinanceDepartment` violates the Single Responsibility Principle (SRP) by containing complex solvency calculation logic. This is a direct contravention of our architectural goals, as documented in `TD-059`.\n\nFurthermore, architectural mandate `TD-058` requires that communication between major components must be done via Data Transfer Objects (DTOs), not by passing entire agent objects. This refactor must strictly adhere to this principle.\n\n**Reference:** `[AUTO-AUDIT FINDINGS] Pre-flight Audit: Domain Logic Refactor`\n\n## 3. Execution Plan\n\n### Step 1: Define the Data Contract (`FinancialStatementDTO`)\n\nIn a suitable DTOs file (e.g., `simulation/dtos/financial_dtos.py`), define a new `TypedDict` or `Dataclass` named `FinancialStatementDTO`.\n\nThis DTO will serve as the standardized data contract for passing financial state. Its structure should be based on the return value of the existing `get_financial_snapshot` method in `FinanceDepartment`.\n\n```python\n# simulation/dtos/financial_dtos.py (Example)\nfrom typing import TypedDict\n\nclass FinancialStatementDTO(TypedDict):\n    total_assets: float\n    working_capital: float\n    retained_earnings: float\n    average_profit: float\n    total_debt: float\n```\n\n### Step 2: Implement the Pure Calculator (`AltmanZScoreCalculator`)\n\nCreate or modify the `simulation/ai/altman_z_score.py` file to contain the `AltmanZScoreCalculator`. This class must be \"pure\" ‚Äî it should have no knowledge of the `Firm` or `FinanceDepartment` objects.\n\nIts sole public method, `calculate`, will accept the `FinancialStatementDTO` as input and return the Z-score as a float. The logic currently inside `FinanceDepartment.calculate_altman_z_score` should be moved here and adapted to read from the DTO.\n\n```python\n# simulation/ai/altman_z_score.py (Example)\nfrom simulation.dtos.financial_dtos import FinancialStatementDTO\n\nclass AltmanZScoreCalculator:\n    \"\"\"Calculates the Altman Z-Score based on a standardized financial snapshot.\"\"\"\n\n    def calculate(self, statement: FinancialStatementDTO) -> float:\n        \"\"\"\n        Calculates the Z-Score using a modified formula for service companies.\n        Z = 1.2*X1 + 1.4*X2 + 3.3*X3\n        \"\"\"\n        if statement[\"total_assets\"] == 0:\n            return 0.0\n\n        # X1: Working Capital / Total Assets\n        x1 = statement[\"working_capital\"] / statement[\"total_assets\"]\n\n        # X2: Retained Earnings / Total Assets\n        x2 = statement[\"retained_earnings\"] / statement[\"total_assets\"]\n\n        # X3: Average Profit / Total Assets\n        x3 = statement[\"average_profit\"] / statement[\"total_assets\"]\n\n        z_score = 1.2 * x1 + 1.4 * x2 + 3.3 * x3\n        return z_score\n```\n\n### Step 3: Refactor `FinanceDepartment`\n\n1.  **Remove Legacy Logic:** Delete the entire `calculate_altman_z_score` method from `simulation/components/finance_department.py`.\n2.  **Implement Delegator Method:** Create a new public method that orchestrates the calculation. This method will construct and pass the DTO to the new calculator.\n\n```python\n# In simulation/components/finance_department.py\n\nfrom simulation.ai.altman_z_score import AltmanZScoreCalculator\nfrom simulation.dtos.financial_dtos import FinancialStatementDTO\n\nclass FinanceDepartment:\n    # ... existing methods ...\n\n    def __init__(self, firm: Firm, config_module: Any):\n        # ...\n        self.solvency_calculator = AltmanZScoreCalculator() # Instantiate the calculator\n\n    # DELETE THE ENTIRE `calculate_altman_z_score` METHOD\n\n    def get_altman_z_score(self) -> float:\n        \"\"\"\n        Calculates the firm's solvency by assembling a financial snapshot\n        and delegating the calculation to the dedicated solvency calculator.\n        \"\"\"\n        # 1. Get the raw financial data.\n        snapshot_data = self.get_financial_snapshot()\n\n        # 2. Assemble the DTO.\n        financial_statement = FinancialStatementDTO(\n            total_assets=snapshot_data[\"total_assets\"],\n            working_capital=snapshot_data[\"working_capital\"],\n            retained_earnings=snapshot_data[\"retained_earnings\"],\n            average_profit=snapshot_data[\"average_profit\"],\n            total_debt=snapshot_data[\"total_debt\"]\n        )\n\n        # 3. Delegate calculation and return the result.\n        return self.solvency_calculator.calculate(financial_statement)\n\n    # ... other methods ...\n```\n\n### Step 4: Update Call Sites\n\nSearch the codebase for any direct calls to `finance_department.calculate_altman_z_score()` and update them to call the new `finance_department.get_altman_z_score()` method.\n\n### Step 5: Refactor Tests\n\n1.  **Test `AltmanZScoreCalculator`:** Create a new test file, `tests/ai/test_altman_z_score.py`. Write focused unit tests that provide various `FinancialStatementDTO` inputs to the calculator and assert that the returned Z-score is correct.\n2.  **Test `FinanceDepartment`:** Modify existing tests for `FinanceDepartment`. Instead of testing the calculation itself, mock the `AltmanZScoreCalculator` and verify that the `get_altman_z_score` method correctly assembles the `FinancialStatementDTO` from the `Firm`'s state and passes it to the mocked calculator.\n\n## 4. Verification (Definition of Done)\n\n- The `calculate_altman_z_score` method has been completely removed from `FinanceDepartment`.\n- The `AltmanZScoreCalculator` class exists, is pure, and performs the Z-score calculation using a `FinancialStatementDTO`.\n- `FinanceDepartment` now uses an instance of `AltmanZScoreCalculator` to perform the solvency check.\n- All pre-existing and new unit tests pass successfully.\n- Technical debt `TD-059` is resolved and can be marked as such in `design/TECH_DEBT_LEDGER.md`.\n"
      },
      "5101605085916374615": {
        "title": "Infra-Cleanup-v2: TD-050, TD-063, TD-051 (Post TD-067)",
        "initial_mission": "# Mission: Infrastructure & Script Maintenance (TD-050, TD-063, TD-051)\n\n## ‚ö†Ô∏è CRITICAL: Architecture Preservation\n**DO NOT MODIFY** any files in:\n- `simulation/firms.py`\n- `simulation/decisions/corporate_manager.py`\n- `simulation/components/*.py`\n\nThe TD-067 SoC refactoring has been completed. Your job is **ONLY** infrastructure cleanup. Do not add wrapper properties, do not change how CorporateManager calls components.\n\n## Context\nAs the project grows, our utility scripts and documentation need stabilization. You are assigned to clean up import logic, exclude noise from health reports, and finalize documentation IDs.\n\n\n## Task Details\n\n### 1. Stable Import Logic (TD-063)\n- **Problem**: Many scripts in `scripts/` use `sys.path.append(os.path.join(os.path.dirname(__file__), '..'))` which is brittle and can fail depending on execution context.\n- **Action**: Refactor all scripts in `scripts/` to use `pathlib` for project root detection.\n- **Goal**: Ensure consistent behavior when run from any directory.\n\n### 2. Cleanup Health Reports (TD-050)\n- **Problem**: `scripts/scan_codebase.py` (or similar audit scripts) scans `scripts/observer/`, leading to false positive complexity alerts in third-party or observer-only code.\n- **Action**: Update the scanning logic to exclude the `scripts/observer/` and `design/` (artifacts) directories from the complexity/SoC analysis.\n\n### 3. Documentation Sanitization (TD-051)\n- **Problem**: Some manuals or specs still contain `WO-XXX` placeholders instead of concrete task IDs.\n- **Action**: Grep for any remaining `WO-XXX` in the `design/` folder and replace them with the actual Work Order IDs (e.g., `WO-083C`) based on the contents of the file or `TECH_DEBT_LEDGER.md`.\n\n## Verification Requirements\n- All refactored scripts must still run correctly (e.g., `python scripts/launcher.py --help`).\n- Run the health scan script and verify `scripts/observer` is no longer in the report.\n- `grep -r \"WO-XXX\" design/` should return zero results.\n\n## Success Criteria\n- ‚úÖ Import logic homogenized using `pathlib`.\n- ‚úÖ Health reports are noise-free.\n- ‚úÖ Documentation is free of placeholders.\n"
      },
      "12825610507285085029": {
        "title": "Finance-Config-v2: TD-034, TD-041 (Post TD-067)",
        "initial_mission": "# Mission: Finance Parameter Migration (TD-034, TD-041)\n\n## ‚ö†Ô∏è CRITICAL: Architecture Preservation\n**DO NOT MODIFY** any files in:\n- `simulation/firms.py` (except reading config values)\n- `simulation/decisions/corporate_manager.py`\n- `simulation/components/*.py` (except adding config reads)\n\nThe TD-067 SoC refactoring is complete. CorporateManager already calls `firm.finance.invest_in_*()` methods. **DO NOT** change this to direct `firm.assets -=` manipulation. Your job is ONLY to move hardcoded constants to config files.\n\n## Context\nWe are moving away from hardcoded economic constants to a fully configurable simulation. Your task is to extract hidden financial parameters into the `config/` system.\n\n## Task Details\n\n### 1. Hardcoded Debt Parameters (TD-034)\n- **Problem**: Bond maturity lengths, risk premia, and debt ceilings are hardcoded in `simulation/agents/government.py` or finance modules.\n- **Action**: \n    - Identify these constants.\n    - Add them to the global config (e.g., `config/economy_params.yaml`).\n    - Update the code to read these via `ConfigManager`.\n\n### 2. Bailout Covenant Ratio (TD-041)\n- **Problem**: The repayment ratio of 0.5 for corporate bailouts is hardcoded.\n- **Action**: \n    - Move `BAILOUT_COVENANT_RATIO` to the configuration system.\n    - Default remains `0.5`, but it must be adjustable without code changes.\n\n## Verification Requirements\n- The simulation must run (`python main.py --ticks 10`) without any change in behavior using default config values.\n- Verify that changing these values in the config file actually affects the simulation (e.g., shorter bond maturity).\n\n## Success Criteria\n- ‚úÖ No hardcoded debt constants in logic files.\n- ‚úÖ Corporate bailout terms are fully configurable.\n"
      },
      "10084796152980908088": {
        "title": "Domain-Logic-v2: TD-059 Altman Z-Score Delegation (Post TD-067)",
        "initial_mission": "# Mission Brief: Domain Logic Refactor (Solvency Calculation)\n\n**TO:** Jules\n**FROM:** Antigravity (via Gemini Scribe)\n**SUBJECT:** Refactor `FinanceDepartment` to Delegate Solvency Logic\n**TRACKING ID:** `WO-084` (Work Order)\n**RELATED DEBT:** `TD-059`, `TD-058`\n\n## ‚ö†Ô∏è CRITICAL: Architecture Preservation\n**DO NOT REGRESS** the TD-067 refactoring:\n- CorporateManager MUST continue calling `firm.finance.invest_in_*()` methods\n- DO NOT change CorporateManager to use `firm.assets -= amount` directly\n- DO NOT add wrapper properties to `Firm` class\n- DO NOT move component methods back to `Firm`\n\nYour task is ONLY to extract Altman Z-Score calculation logic, not to restructure how Firm/CorporateManager interact.\n\n---\n\n## 1. Objective\n\nRefactor the `FinanceDepartment` component to eliminate its internal `calculate_altman_z_score` method. All solvency calculations must be delegated to a dedicated, pure `AltmanZScoreCalculator` component, adhering to our established DTO-based communication protocol. This action will resolve technical debt `TD-059` and enforce the Single Source of Truth (SSOT) principle for financial analytics.\n\n## 2. Context & Architectural Mandate\n\nThe recent pre-flight audit confirmed that `FinanceDepartment` violates the Single Responsibility Principle (SRP) by containing complex solvency calculation logic. This is a direct contravention of our architectural goals, as documented in `TD-059`.\n\nFurthermore, architectural mandate `TD-058` requires that communication between major components must be done via Data Transfer Objects (DTOs), not by passing entire agent objects. This refactor must strictly adhere to this principle.\n\n**Reference:** `[AUTO-AUDIT FINDINGS] Pre-flight Audit: Domain Logic Refactor`\n\n## 3. Execution Plan\n\n### Step 1: Define the Data Contract (`FinancialStatementDTO`)\n\nIn a suitable DTOs file (e.g., `simulation/dtos/financial_dtos.py`), define a new `TypedDict` or `Dataclass` named `FinancialStatementDTO`.\n\nThis DTO will serve as the standardized data contract for passing financial state. Its structure should be based on the return value of the existing `get_financial_snapshot` method in `FinanceDepartment`.\n\n```python\n# simulation/dtos/financial_dtos.py (Example)\nfrom typing import TypedDict\n\nclass FinancialStatementDTO(TypedDict):\n    total_assets: float\n    working_capital: float\n    retained_earnings: float\n    average_profit: float\n    total_debt: float\n```\n\n### Step 2: Implement the Pure Calculator (`AltmanZScoreCalculator`)\n\nCreate or modify the `simulation/ai/altman_z_score.py` file to contain the `AltmanZScoreCalculator`. This class must be \"pure\" ‚Äî it should have no knowledge of the `Firm` or `FinanceDepartment` objects.\n\nIts sole public method, `calculate`, will accept the `FinancialStatementDTO` as input and return the Z-score as a float. The logic currently inside `FinanceDepartment.calculate_altman_z_score` should be moved here and adapted to read from the DTO.\n\n```python\n# simulation/ai/altman_z_score.py (Example)\nfrom simulation.dtos.financial_dtos import FinancialStatementDTO\n\nclass AltmanZScoreCalculator:\n    \"\"\"Calculates the Altman Z-Score based on a standardized financial snapshot.\"\"\"\n\n    def calculate(self, statement: FinancialStatementDTO) -> float:\n        \"\"\"\n        Calculates the Z-Score using a modified formula for service companies.\n        Z = 1.2*X1 + 1.4*X2 + 3.3*X3\n        \"\"\"\n        if statement[\"total_assets\"] == 0:\n            return 0.0\n\n        # X1: Working Capital / Total Assets\n        x1 = statement[\"working_capital\"] / statement[\"total_assets\"]\n\n        # X2: Retained Earnings / Total Assets\n        x2 = statement[\"retained_earnings\"] / statement[\"total_assets\"]\n\n        # X3: Average Profit / Total Assets\n        x3 = statement[\"average_profit\"] / statement[\"total_assets\"]\n\n        z_score = 1.2 * x1 + 1.4 * x2 + 3.3 * x3\n        return z_score\n```\n\n### Step 3: Refactor `FinanceDepartment`\n\n1.  **Remove Legacy Logic:** Delete the entire `calculate_altman_z_score` method from `simulation/components/finance_department.py`.\n2.  **Implement Delegator Method:** Create a new public method that orchestrates the calculation. This method will construct and pass the DTO to the new calculator.\n\n```python\n# In simulation/components/finance_department.py\n\nfrom simulation.ai.altman_z_score import AltmanZScoreCalculator\nfrom simulation.dtos.financial_dtos import FinancialStatementDTO\n\nclass FinanceDepartment:\n    # ... existing methods ...\n\n    def __init__(self, firm: Firm, config_module: Any):\n        # ...\n        self.solvency_calculator = AltmanZScoreCalculator() # Instantiate the calculator\n\n    # DELETE THE ENTIRE `calculate_altman_z_score` METHOD\n\n    def get_altman_z_score(self) -> float:\n        \"\"\"\n        Calculates the firm's solvency by assembling a financial snapshot\n        and delegating the calculation to the dedicated solvency calculator.\n        \"\"\"\n        # 1. Get the raw financial data.\n        snapshot_data = self.get_financial_snapshot()\n\n        # 2. Assemble the DTO.\n        financial_statement = FinancialStatementDTO(\n            total_assets=snapshot_data[\"total_assets\"],\n            working_capital=snapshot_data[\"working_capital\"],\n            retained_earnings=snapshot_data[\"retained_earnings\"],\n            average_profit=snapshot_data[\"average_profit\"],\n            total_debt=snapshot_data[\"total_debt\"]\n        )\n\n        # 3. Delegate calculation and return the result.\n        return self.solvency_calculator.calculate(financial_statement)\n\n    # ... other methods ...\n```\n\n### Step 4: Update Call Sites\n\nSearch the codebase for any direct calls to `finance_department.calculate_altman_z_score()` and update them to call the new `finance_department.get_altman_z_score()` method.\n\n### Step 5: Refactor Tests\n\n1.  **Test `AltmanZScoreCalculator`:** Create a new test file, `tests/ai/test_altman_z_score.py`. Write focused unit tests that provide various `FinancialStatementDTO` inputs to the calculator and assert that the returned Z-score is correct.\n2.  **Test `FinanceDepartment`:** Modify existing tests for `FinanceDepartment`. Instead of testing the calculation itself, mock the `AltmanZScoreCalculator` and verify that the `get_altman_z_score` method correctly assembles the `FinancialStatementDTO` from the `Firm`'s state and passes it to the mocked calculator.\n\n## 4. Verification (Definition of Done)\n\n- The `calculate_altman_z_score` method has been completely removed from `FinanceDepartment`.\n- The `AltmanZScoreCalculator` class exists, is pure, and performs the Z-score calculation using a `FinancialStatementDTO`.\n- `FinanceDepartment` now uses an instance of `AltmanZScoreCalculator` to perform the solvency check.\n- All pre-existing and new unit tests pass successfully.\n- Technical debt `TD-059` is resolved and can be marked as such in `design/TECH_DEBT_LEDGER.md`.\n"
      },
      "10501622868201374933": {
        "title": "Finance-Config-v3: TD-034, TD-041 (Post Infra Merge)",
        "initial_mission": "# Mission: Finance Parameter Migration (TD-034, TD-041)\n\n## ‚ö†Ô∏è CRITICAL: Architecture Preservation\n**DO NOT MODIFY** any files in:\n- `simulation/firms.py` (except reading config values)\n- `simulation/decisions/corporate_manager.py`\n- `simulation/components/*.py` (except adding config reads)\n\nThe TD-067 SoC refactoring is complete. CorporateManager already calls `firm.finance.invest_in_*()` methods. **DO NOT** change this to direct `firm.assets -=` manipulation. Your job is ONLY to move hardcoded constants to config files.\n\n## Context\nWe are moving away from hardcoded economic constants to a fully configurable simulation. Your task is to extract hidden financial parameters into the `config/` system.\n\n## Task Details\n\n### 1. Hardcoded Debt Parameters (TD-034)\n- **Problem**: Bond maturity lengths, risk premia, and debt ceilings are hardcoded in `simulation/agents/government.py` or finance modules.\n- **Action**: \n    - Identify these constants.\n    - Add them to the global config (e.g., `config/economy_params.yaml`).\n    - Update the code to read these via `ConfigManager`.\n\n### 2. Bailout Covenant Ratio (TD-041)\n- **Problem**: The repayment ratio of 0.5 for corporate bailouts is hardcoded.\n- **Action**: \n    - Move `BAILOUT_COVENANT_RATIO` to the configuration system.\n    - Default remains `0.5`, but it must be adjustable without code changes.\n\n## Verification Requirements\n- The simulation must run (`python main.py --ticks 10`) without any change in behavior using default config values.\n- Verify that changing these values in the config file actually affects the simulation (e.g., shorter bond maturity).\n\n## Success Criteria\n- ‚úÖ No hardcoded debt constants in logic files.\n- ‚úÖ Corporate bailout terms are fully configurable.\n"
      }
    },
    "completed_sessions": {
      "9966767717181422022": "TD-067-Phase-A: Firm Logic Consolidation - MERGED 2026-01-20",
      "18090137123816755263": "WO-083C-P3-REWORK: Fix Regression & Migrate Test - MERGED 2026-01-20",
      "16457788477972542743": "TD-065 Household God Class Refactoring - COMPLETED 2026-01-20",
      "8108259102747887077": "TD-067 Phase B/C: Firm Facade Deconstruction - MERGED 2026-01-20",
      "13554214772414011208": "TD-066 Simulation God Class Refactor - COMPLETED 2026-01-20",
      "1212660192877761122": "WO-083C P1 Low Risk Migration - COMPLETED 2026-01-20",
      "13794252736923687768": "WO-083C P2 Medium Risk Migration - COMPLETED 2026-01-20",
      "11016259656214972314": "WO-083C P3 High Risk Migration (Old) - REJECTED 2026-01-20",
      "6980280111914954682": "WO-083C P3 High Risk Migration (Incomplete) - ARCHIVED 2026-01-20",
      "3970950953200710533": "TD-067 Phase A Initial Attempt - ARCHIVED 2026-01-20",
      "8111922141870240162": "WO-083C-P1: Test Migration (LOW Risk) - MERGED 2026-01-20",
      "11202564815416347618": "WO-083C-P2: Test Migration (MEDIUM Risk) - MERGED 2026-01-20",
      "9067551690220486700": "WO-083C-P3: Test Migration (HIGH Risk) - MERGED 2026-01-20",
      "6338045545797855725": "WO-083A: Golden Fixture Generation - MERGED 2026-01-20",
      "11560612815746517359": "WO-083A: Golden Fixture Generation - MERGED 2026-01-20",
      "1503508227423661963": "WO-083B: Test Migration Phase 1 - MERGED 2026-01-20",
      "16754935071282510850": "WO-081: Bank Interface Segregation - MERGED 2026-01-19",
      "15965755950889487504": "WO-082: Golden Loader Infrastructure - MERGED 2026-01-19",
      "17536225839445736015": "Phase-29_The_Depression - COMPLETED 2026-01-19",
      "5597989927571483094": "TD-043/044/045 God Class Refactoring - MERGED 2026-01-18",
      "14826170066369985962": "TD-008 Finance Upgrade - MERGED 2026-01-16",
      "2244231495852370011": "WO-079 Config Automation v2 - MERGED 2026-01-16",
      "12543922642187456551": "TD-045 Firm God Class - COMPLETED 2026-01-16",
      "4889257989211040620": "TD-044 Household God Class - COMPLETED 2026-01-16",
      "5283327958326335498": "TD-024 Post-Fix Test - COMPLETED 2026-01-16",
      "8465436477342866436": "WO-037 Simulation Cockpit - MERGED 2026-01-16",
      "15007179683109829611": "WO-060 - MERGED 2026-01-15",
      "7095675393629273222": "WO-064: Banking Credit Engine - MERGED 2026-01-15",
      "10296031762289509515": "WO-065: Monetary Integrity & Suture - MERGED 2026-01-15",
      "14018014647659914271": "WO-062: Macro-Linked Portfolio - MERGED 2026-01-15",
      "9343683714945509652": "WO-066: High-Fidelity Sensory Architecture - MERGED 2026-01-15",
      "9719318674264407147": "WO-067: High-Fidelity Reaction Test - MERGED 2026-01-15",
      "3778947626343557354": "WO-057-Refine Shock Therapy (Retry) - MERGED 2026-01-14",
      "11626928342509996952": "TD-014: Government SoC Refactoring - MERGED 2026-01-14",
      "10078451815509526740": "WO-058-Retry: Operation Defibrillator - MERGED 2026-01-14",
      "4444007150223365139": "WO-058 Economic CPR - MERGED 2026-01-14"
    }
  }
}