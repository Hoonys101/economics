# [TD-198] MortgageApplicationDTO Unification

## Context
There were two conflicting definitions of `MortgageApplicationDTO`:
1. `modules/market/housing_planner_api.py` (Canonical)
2. `modules/market/housing_purchase_api.py` (Duplicate, with different keys)

This caused confusion and required compatibility layers in `LoanMarket`.

## Resolution
- Removed the duplicate definition from `modules/market/housing_purchase_api.py` and `modules/housing/dtos.py`.
- Unified all usages to import from `modules/market/housing_planner_api.py`.
- Updated `LoanMarket`, `SettlementSystem`, and consumers to use the canonical keys:
    - `principal` (vs `loan_principal`)
    - `property_value` (vs `offer_price`)
    - `applicant_income` (vs `applicant_gross_income`)
    - `applicant_existing_debt` (Total debt balance)

## Technical Debt / Insights
- **Precision Loss**: The canonical DTO uses `applicant_existing_debt` (Total Balance) and does not have a field for `applicant_existing_debt_payments` (Monthly). The `LoanMarket` now estimates monthly payments based on total debt if the Bank service cannot provide exact figures. This is acceptable for now but might be a limitation if third-party debt (non-bank) with specific payment schedules needs to be modeled.
- **Legacy Compatibility**: `LoanMarket` had extensive fallback logic which was removed. This cleans up the code but requires all callers to strict adhere to the canonical DTO.
- **Saga Data**: `HousingPurchaseSagaDataDTO` now embeds the canonical `MortgageApplicationDTO`. This ensures the Saga carries the exact data structure used by the planner and the bank.

## Action Items
- Verify if `applicant_existing_debt` needs to be split into `total_debt` and `monthly_debt_service` in the future if accurate DTI calculations for external debt are required.
