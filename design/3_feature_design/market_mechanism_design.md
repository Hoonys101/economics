# 시장 메커니즘 설계 (V2)

## 1. 목표

이 문서는 경제 시뮬레이션의 핵심 문제인 '임금 경직성'과 '가격 불안정성'을 해결하기 위한 새로운 시장 메커니즘(V2)을 설계합니다. V1 모델의 실패 원인을 분석하고, 보다 현실적이고 안정적인 가격 발견(Price Discovery) 메커니즘을 도입하는 것을 목표로 합니다.

## 2. 핵심 원칙: 창발적 가격 (Emergent Price)

V2 설계의 가장 중요한 변화는 **가격이 시장의 상호작용으로부터 창발되는 속성**이라는 점을 명확히 하는 것입니다. V1 모델처럼 각 에이전트가 독립적으로 '적정 가격'을 계산하는 방식에서 벗어나, 시장의 피드백을 통해 가격이 동적으로 조정되는 메커니즘을 구현합니다.

- **V1 (실패 모델):** 가계와 기업이 각자 비슷한 공식으로 임금/가격을 계산 → 일치할 때만 거래 → 경직성 발생.
- **V2 (신규 모델):** 한쪽(판매자)이 가격을 제시 → 다른 쪽(구매자)이 수용 여부 결정 → 판매 결과(재고 소진, 고용 실패 등)에 따라 판매자가 다음 턴의 가격을 조정.

## 3. 노동 시장 재설계 (V2)

임금 경직성 문제를 해결하기 위해, 기업이 임금을 제시하고 가계가 수락하는 비대칭적 구조를 도입합니다.

### 3.1. 기업 (Firm) - 임금 오퍼 로직

1.  **기본 임금 설정:** 기업은 이전 틱의 **시장 평균 임금(`avg_wage`)**을 기준점으로 삼습니다. (첫 틱은 `BASE_WAGE` 사용)
2.  **수익성 프리미엄:** 기업의 수익성(`profit`)에 따라 임금에 프리미엄을 추가합니다. 수익이 높은 기업은 더 높은 임금을 제시하여 우수한 인재를 유치하려 할 것입니다.
3.  **경쟁 프리미엄 (고용 실패 피드백):** 만약 이전 틱에서 노동력이 필요했음에도 불구하고 신규 고용에 실패했다면(`hires_last_tick == 0`), 다음 틱에서 임금 오퍼를 **대폭 상향** 조정합니다. 이는 노동 시장의 경쟁을 시뮬레이션합니다.

### 3.2. 가계 (Household) - 직업 수락 로직

1.  **시장 탐색:** 실업 상태인 가계는 노동 시장에 게시된 모든 기업의 임금 오퍼를 확인합니다.
2.  **기대 임금 계산:** 가계는 자신의 생존에 필요한 비용(특히 `food_avg_price`)을 기반으로 최소한의 **기대 임금(`reservation_wage`)**을 설정합니다.
3.  **직업 선택:** 시장에 나온 오퍼 중 자신의 기대 임금을 충족하는 가장 높은 임금의 일자리를 선택하고 수락합니다.

## 4. 상품 시장 재설계 (V2)

가격 폭등 문제를 해결하기 위해, 기업이 재고 수준에 따라 가격을 동적으로 조정하는 피드백 루프를 도입합니다.

### 4.1. 기업 (Firm) - 상품 가격 책정 로직

1.  **기본 가격 설정:** 생산 비용(임금, 원자재 등)에 기반한 **원가 가산 방식(Cost-plus markup)**으로 초기 가격을 설정합니다.
2.  **재고 기반 가격 조정 (판매 결과 피드백):**
    *   **재고 소진 시 (Sold Out):** 만약 이전 틱에서 상품이 너무 빨리 모두 팔렸다면, 이는 가격이 너무 낮다는 신호입니다. 다음 틱에서 가격을 **인상**합니다.
    *   **재고 누적 시 (Overstock):** 만약 재고가 목표치 이상으로 계속 쌓인다면, 가격이 너무 높다는 신호입니다. 다음 틱에서 가격을 **인하**하여 재고를 소진하려 시도합니다.

### 4.2. 가계 (Household) - 상품 구매 로직

1.  **필요 기반 구매:** 가계는 자신의 욕구(needs)를 충족시키기 위해 필요한 상품을 식별합니다.
2.  **예산 제약:** 가계는 자신의 가용 예산(`consumption_budget`) 내에서 구매를 결정합니다.
3.  **가격 수용:** 가계는 시장에 제시된 가격을 보고 구매 여부를 결정합니다. V1처럼 지불 의사 가격을 복잡하게 계산하여 오더를 내는 것이 아니라, 제시된 가격을 수용하거나 포기합니다.

## 5. V1 대비 주요 변경점

- **비대칭적 가격 결정:** 임금과 상품 가격 모두 판매자(기업)가 제시하고 구매자(가계)가 수락하는 구조로 변경하여, 양측이 동일한 공식을 사용하던 문제를 해결합니다.
- **시장 피드백 루프 강화:** 고용 실패, 재고 수준 등 명확한 시장의 피드백을 가격 결정의 핵심 요소로 사용하여, 가격이 시장 상황에 맞게 동적으로 움직이도록 합니다.
- **에이전트 로직 간소화:** 가계의 복잡한 지불 의사 가격 계산 로직을 단순화하고, 시장에 제시된 가격에 대한 반응으로 초점을 맞춥니다.
