# 마스터 플랜 (Master Plan)

이 문서는 경제 시뮬레이션 프로젝트의 최상위 계획을 정의하고, 현재 상태와 향후 진행 방향을 제시하는 마스터 문서입니다.

## 1. 프로젝트 비전 및 목표

복잡계 경제학 원리를 기반으로 AI 에이전트(가계, 기업) 모델을 구축하여, 현실 경제 현상을 모사하고 분석하는 것을 목표로 합니다. 각 에이전트는 내재된 욕구와 AI 의사결정 엔진을 통해 자율적으로 행동하며, 이들의 상호작용으로부터 거시 경제 현상이 창발되는 과정을 관찰합니다.

- **핵심 목표:**
    1.  현실적인 에이전트 모델링 (욕구 기반, AI 의사결정)
    2.  동적 시장 메커니즘 구현 (수요-공급, 가격 결정)
    3.  AI 의사결정 엔진의 학습 및 진화
    4.  웹 기반 시각화 및 분석 도구 구축
    5.  확장 가능한 아키텍처 설계

## 2. 핵심 아키텍처

- **에이전트 기반 모델 (Agent-Based Model):** 가계와 기업 에이전트의 상호작용이 시뮬레이션의 중심입니다.
- **의사결정 엔진 분리 (Decision Engine):** 에이전트의 상태(`Agent` 클래스)와 행동 로직(`DecisionEngine` 클래스)을 분리하여 유연성과 테스트 용이성을 확보합니다.
- **AI 훈련 관리자 분리 (AITrainingManager):** AI 모델의 훈련/관리(`AITrainingManager`)와 실제 의사결정(`AIDecisionEngine`)의 책임을 명확히 분리합니다.
- **오더북 시장 (Order Book Market):** 주식 시장과 유사한 오더북 기반 연속 이중 경매 시장을 통해 현실적인 거래 및 가격 발견 메커니즘을 구현합니다.
- **중앙 집중식 로깅 (Centralized Logging):** `log_config.json`을 통해 프로젝트 전체의 로깅을 중앙에서 제어하여 디버깅 효율을 극대화합니다.

## 3. 현재 상태 (2025-09-01 기준)

- **AI 통합 완료:** 가계 에이전트에 AI 의사결정 엔진이 통합되어 작동하고 있습니다.
- **주요 버그 해결:** 시뮬레이션 실행을 방해하던 다수의 `TypeError`, `AttributeError`, `NameError` 등의 주요 버그들이 해결되었습니다.
- **시뮬레이션 실행 가능:** 현재 시뮬레이션은 100틱 이상 안정적으로 실행 가능하며, `results_baseline.csv`와 `results_experiment.csv` 같은 결과물을 생성할 수 있습니다.
- **식별된 주요 문제:**
    1.  **직원 유지 문제:** `simulation/engine.py`의 로직 오류로 인해 기업이 직원을 유지하지 못하여, 모든 기업의 **생산량이 0이 되는 심각한 버그**가 남아있습니다. (수정 필요)
    2.  **UI 성능 저하:** 웹 UI의 응답 속도가 매우 느려 실시간 분석이 어렵습니다.
    3.  **UI 데이터 정확성:** 실업률 등 일부 UI 데이터가 정확하게 표시되지 않는 문제가 있습니다.

## 4. 우선순위 백로그 (Next Steps)

다음은 프로젝트 안정화와 핵심 기능 검증을 위한 최우선 과제입니다.

1.  **[P0 - Blocker] 기업 생산량 0 버그 수정:**
    -   **내용:** `simulation/engine.py`에서 매 틱마다 가계의 고용 상태를 리셋하는 로직을 제거하여, 기업이 직원을 유지하고 생산 활동을 할 수 있도록 수정합니다.
    -   **목표:** 시뮬레이션의 가장 기본적인 경제 순환(고용 → 생산 → 소득)을 복구합니다.

2.  **[P1 - Critical] 수요-공급 법칙 검증:**
    -   **내용:** 'food' 공급량을 인위적으로 늘리는 실험을 통해, 시장 가격이 하락하고 거래량이 증가하는지 검증합니다.
    -   **목표:** 시뮬레이션 모델이 경제학의 기본 원리를 따르는지 확인하여 모델의 신뢰성을 확보합니다.

3.  **[P2 - Major] UI 성능 개선 및 정확성 확보:**
    -   **내용:** 웹 UI의 백엔드(`app.py`)와 프론트엔드(`index.html`)의 API 호출 및 데이터 처리 로직을 최적화하여 성능을 개선하고, 실업률 등 부정확한 데이터 표시 문제를 해결합니다.
    -   **목표:** 실시간 분석이 가능한 수준의 쾌적하고 정확한 UI 환경을 구축합니다.

4.  **[P2 - Major] 핵심 로직 단위/통합 테스트 작성:**
    -   **내용:** `pytest`를 사용하여 `DecisionEngine`, `Market`, `Agent`의 핵심 메서드에 대한 단위 테스트와 통합 테스트를 작성합니다.
    -   **목표:** 코드 변경에 따른 회귀 버그를 방지하고, 코드의 안정성과 신뢰성을 장기적으로 확보합니다.

5.  **[P3 - Minor] 코드베이스 리팩토링:**
    -   **내용:** `BaseAgent` 클래스를 도입하여 에이전트 간 공통 로직을 추상화하고, 고급 로깅 전략을 적용합니다.
    -   **목표:** 코드의 유지보수성과 확장성을 향상시킵니다.
