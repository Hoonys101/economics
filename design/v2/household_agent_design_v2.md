# 가계 에이전트 설계 (V2)

## 1. 목표

이 문서는 V2 시장 메커니즘 하에서 가계(Household) 에이전트의 의사결정 알고리즘을 구체적으로 정의합니다. 가계는 시장에 제시된 가격을 바탕으로 자신의 효용을 극대화하는 합리적인 선택을 하도록 설계됩니다.

## 2. 핵심 속성

- `assets`: 자산
- `needs`: 욕구 (생존, 인정, 성장 등)
- `inventory`: 재고
- `is_employed`: 고용 상태 (True/False)
- `employer_id`: 고용주 ID
- `reservation_wage`: 노동을 제공할 용의가 있는 최소 기대 임금

## 3. 의사결정 알고리즘 (V2)

가계의 의사결정은 **전략(AI)**과 **전술(규칙)**의 두 계층으로 분리됩니다.

### 3.1. 전술 계층: 규칙 기반 시장 참여

시장에서의 실제 주문(Order) 생성은 명확한 규칙에 따라 수행됩니다.

#### 3.1.1. 노동 공급 (실업 상태일 경우)

1.  **기대 임금 설정:** 자신의 생존에 필요한 최소 비용(주로 이전 틱의 `food_avg_price`에 기반)을 계산하여 `reservation_wage`를 결정합니다.
2.  **노동 시장 탐색:** 노동 시장에 게시된 모든 기업의 채용 공고(임금 오퍼)를 확인합니다.
3.  **최적 직업 선택:** 자신의 `reservation_wage`를 만족하는 일자리 중 가장 높은 임금을 제시하는 기업을 선택합니다.
4.  **노동 판매 주문:** 해당 기업의 임금 오퍼에 맞춰 노동 판매(SELL) 주문을 제출합니다. 만약 만족하는 일자리가 없으면 노동을 제공하지 않습니다.

##### 3.1.1.1. 동적 기대 임금 조정 (유동성 필요 기반)

가계가 장기간 실업 상태에 빠져 생존이 위협받는 상황을 시뮬레이션하기 위해, 기대 임금을 동적으로 조정하는 메커니즘을 도입합니다.

- **유동성 위기 감지:** 가계의 현금성 자산(`assets`)이 특정 임계값 (예: 3개월치 최소 식량 구매 비용) 이하로 감소하면, '유동성 필요(`liquidity_need`)' 욕구 수치가 급격히 상승합니다.
- **기대 임금 하향 조정:** `reservation_wage`를 계산할 때, 이 '유동성 필요' 수치에 반비례하는 가중치를 적용합니다. 즉, `liquidity_need`가 높을수록(현금이 급할수록) 기대 임금이 낮아져, 이전에는 거부했을 낮은 임금의 일자리도 수락할 가능성이 높아집니다. 이는 생존을 위한 가계의 합리적인 선택을 모방합니다.

#### 3.1.2. 상품 소비

1.  **예산 책정:** 현재 자산과 저축 계획(AI가 결정)에 따라 이번 틱에서 사용할 `consumption_budget`을 결정합니다.
2.  **필요 상품 식별 및 우선순위:** 현재 가장 높은 욕구(needs)를 충족시켜줄 상품을 우선순위로 정합니다.
    *   특히, `survival_need`가 임계치 이상으로 높을 경우, 다른 모든 욕구보다 'food' 구매에 최우선 순위를 둡니다. AI는 생존을 위해 높은 가격이라도 지불할 용의가 있음을 학습하게 됩니다.
3.  **상품 시장 탐색:** 상품 시장에서 필요한 상품의 현재 판매 가격을 확인합니다.
4.  **구매 결정:** 예산 내에서 우선순위가 가장 높은 상품부터 구매합니다. V1과 달리 복잡한 지불의사 가격을 계산하지 않고, 시장에 제시된 가격이 예산을 초과하지 않으면 구매합니다.

### 3.2. 전략 계층: AI의 역할

AI는 더 이상 가격을 직접 계산하지 않습니다. 대신, 규칙 기반의 전술적 행동이 더 나은 결과를 내도록 **전략적 목표와 가중치를 조정**하는 역할을 수행합니다.

- **소비 vs 저축 결정:** 현재 시장 상황(물가, 임금)과 미래 예측을 바탕으로, 이번 틱의 소비 예산과 저축액의 비율을 결정합니다. (예: 물가가 비싸면 소비를 줄이고 저축을 늘림)
- **고급 상품 선호도 결정:** 생존에 필요한 기본 상품 외에, 어떤 고급 상품(사치재)을 구매하여 '인정 욕구'나 '성장 욕구'를 채울지 결정합니다.
- **이직 및 경력 개발 결정:** 현재 직장의 임금과 노동 시장의 평균 임금을 비교하여, 더 나은 조건의 직장으로 이직을 시도할지 결정합니다. 또는, 특정 기술(skill)을 학습하여 자신의 가치를 높일지 결정합니다.
