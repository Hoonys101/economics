# 기업 에이전트 설계 (V2)

## 1. 목표

이 문서는 V2 시장 메커니즘 하에서 기업(Firm) 에이전트의 의사결정 알고리즘을 구체적으로 정의합니다. 기업은 이윤 극대화를 목표로, 시장 피드백에 따라 생산, 고용, 가격 책정을 동적으로 조정하도록 설계됩니다.

## 2. 핵심 속성

- `assets`: 자산
- `inventory`: 상품 재고
- `employees`: 고용된 직원 리스트
- `profit`: 수익
- `production_target`: 생산 목표량
- `offered_wage`: 노동 시장에 제시하는 임금

## 3. 의사결정 알고리즘 (V2)

기업의 의사결정은 **전략(AI)**과 **전술(규칙)**의 두 계층으로 분리됩니다.

### 3.1. 전술 계층: 규칙 기반 시장 참여

#### 3.1.1. 생산량 결정

- **재고 기반 조절:** 이전 틱의 재고 수준을 확인하여 생산 목표(`production_target`)를 조정합니다. 이 로직은 V1과 거의 동일하게 유지됩니다.
    - 재고 > 목표치 * `OVERSTOCK_THRESHOLD` → 생산량 감소
    - 재고 < 목표치 * `UNDERSTOCK_THRESHOLD` → 생산량 증가

#### 3.1.2. 노동 수요 및 임금 결정 (고용)

1.  **필요 노동력 계산:** 조정된 `production_target`을 달성하는 데 필요한 총 노동력(`needed_labor`)을 계산합니다.
2.  **임금 오퍼 계산:**
    - **기준점:** 이전 틱의 시장 평균 임금(`avg_wage`)을 기본 오퍼의 기준으로 삼습니다.
    - **수익성 프리미엄:** 현재 기업의 수익성(`profit`)에 비례하여 프리미엄을 추가합니다. 이익이 많이 나는 기업은 더 높은 임금을 제시할 수 있습니다.
    - **경쟁 프리미엄:** 만약 `needed_labor`가 현재 직원보다 많고, 이전 틱에서 신규 채용에 실패했다면(`hires_last_tick == 0`), 임금 오퍼를 대폭 상향하여 노동 시장에서의 경쟁력을 높입니다.
3.  **채용 공고:** 계산된 `offered_wage`로 노동 시장에 노동 구매(BUY) 주문을 제출합니다.

#### 3.1.3. 상품 가격 결정 (판매)

1.  **원가 계산:** 상품 생산에 투입된 총비용(주로 임금)을 기반으로 상품의 생산 원가를 계산합니다.
2.  **가격 책정:**
    - **기본 가격:** `생산 원가 * (1 + profit_markup)` 공식을 사용하여 기본 판매 가격을 설정합니다. `profit_markup`은 AI가 결정하는 전략 변수입니다.
    - **재고 피드백 조정:** 이전 틱의 판매 실적에 따라 가격을 미세 조정합니다.
        - **완판(Sold Out) 시:** 가격이 너무 낮다고 판단하여 다음 틱의 가격을 인상합니다.
        - **재고 누적 시:** 가격이 너무 높다고 판단하여 다음 틱의 가격을 인하합니다.
3.  **상품 판매:** 책정된 가격으로 상품 시장에 상품 판매(SELL) 주문을 제출합니다.

### 3.2. 전략 계층: AI의 역할

AI는 기업의 **지속 가능한 장기 이윤 극대화**를 위해 다음과 같은 핵심 전략 변수들을 조정합니다.

- **이윤 마진(`profit_markup`) 결정:** 시장의 경쟁 강도와 수요를 예측하여, 상품 가격에 얼마나 많은 이윤을 붙일지 결정합니다. (높은 마진 = 고수익이지만 판매량 감소 위험, 낮은 마진 = 박리다매)
- **생산 목표(`production_target`) 설정:** 단기적인 재고 수준을 넘어, 미래의 수요를 예측하여 최적의 생산량을 결정합니다.
- **R&D 투자 결정:** 현재 수익의 일부를 R&D에 투자하여 미래의 생산성(`productivity_factor`)을 높일지, 아니면 단기 이익을 극대화할지 결정합니다.

## 4. 경제적 압박 및 성장 동기

현실의 기업처럼, 시뮬레이션의 기업도 현실 안주에 빠지지 않고 끊임없이 이윤을 추구하도록 만드는 동기가 필요합니다. 이를 위해 다음과 같은 비용 압박 메커니즘을 도입합니다.

### 4.1. 고정 운영 비용 (Fixed Operating Costs)

- **내용:** 매 틱(또는 일정 주기)마다 모든 기업은 생산량과 관계없이 임대료, 관리비 등과 같은 고정 비용을 지불합니다.
- **효과:** 이윤을 내지 못하는 기업은 자산이 꾸준히 감소하므로, 최소한 고정 비용 이상의 이익을 내도록 행동하게 만드는 강력한 생존 압박으로 작용합니다.

### 4.2. 의무 배당금 지급 (Mandatory Dividend Payouts)

- **내용:** 기업이 이익을 냈을 경우, 이익의 일정 비율(`DIVIDEND_RATE`)을 주주(가계)에게 의무적으로 배당해야 합니다.
- **효과:** 기업이 이윤을 무한정 축적하는 것을 방지하고, '주주 가치 극대화'라는 현실적인 목표를 부여합니다. 이는 기업 AI가 단기적 생존을 넘어 장기적인 고수익을 추구하도록 유도하는 핵심 동기가 됩니다.