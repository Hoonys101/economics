# 테스트 전략 설계 (Test Strategy Design)

## 1. 자동화된 단위/통합 테스트 도입 (pytest)

### 1.1. 문제점
- 현재 프로젝트는 로그 분석에 의존하는 수동적인 검증 방식을 사용하고 있습니다. 이는 비효율적이며, 코드 변경이 기존 기능에 미치는 영향을 확인하기 어렵게 만들어 회귀(regression) 버그 발생 가능성을 높입니다.

### 1.2. 개선 방안
- Python의 `pytest` 프레임워크를 도입하여 시뮬레이션의 핵심 로직에 대한 자동화된 테스트 코드를 작성합니다.
- 테스트는 크게 단위 테스트(Unit Test)와 통합 테스트(Integration Test)로 구분하여 진행합니다.

### 1.3. 테스트 유형별 상세 계획

#### 1.3.1. 단위 테스트 (Unit Tests)
- **목표:** 각 클래스, 메서드, 함수의 개별적인 기능이 올바르게 동작하는지 검증합니다.
- **대상:**
    - `DecisionEngine` (HouseholdDecisionEngine, FirmDecisionEngine, AIDecisionEngine): 특정 입력(에이전트 상태, 시장 데이터)에 대해 올바른 주문(Order)을 생성하는지 검증합니다.
    - `Market` (GoodsMarket, LaborMarket): 주어진 구매/판매 주문을 정확하게 매칭하고, 올바른 거래(Transaction)를 생성하는지, 그리고 시장 상태(예: 주문 목록)가 올바르게 업데이트되는지 검증합니다.
    - `Agent` (Household, Firm)의 핵심 메서드: `update_needs`, `consume`, `produce` 등 개별 로직이 예상대로 동작하는지 검증합니다.
    - `Logger`: 로그 메시지가 올바른 형식으로 기록되고, 샘플링 로직이 적용되는지 등을 검증합니다.
- **방법:** 각 테스트 대상의 의존성을 모의(mock)하거나 스텁(stub) 처리하여, 해당 단위의 기능에만 집중하여 테스트합니다.

#### 1.3.2. 통합 테스트 (Integration Tests)
- **목표:** 여러 모듈 또는 시스템 컴포넌트가 함께 작동하여 예상대로 동작하는지 검증합니다.
- **대상:**
    - 시뮬레이션 틱 실행 (`Simulation.run_tick`): 1틱 또는 소수의 틱을 실행했을 때, 에이전트의 자산, 재고, 욕구, 시장 상태 등이 예상대로 변경되고 거래가 올바르게 처리되는지 검증합니다.
    - 시장 상호작용: 가계가 상품을 구매하고 기업이 생산하여 판매하는 일련의 과정이 올바르게 연결되는지 검증합니다.
    - AI 의사결정 흐름: AI 에이전트가 의사결정을 내리고, 그 결과가 시뮬레이션에 반영되는 전체 흐름을 검증합니다.
- **방법:** 실제 객체들을 사용하여 모듈 간의 상호작용을 테스트합니다. 시뮬레이션의 초기 상태를 설정하고, 몇 틱을 실행한 후 최종 상태를 검증하는 방식으로 진행합니다.

### 1.4. 예상 효과
- **버그 조기 발견:** 개발 초기 단계에서 버그를 발견하여 수정 비용을 절감합니다.
- **회귀 방지:** 코드 변경 시 기존 기능의 오작동을 방지하여 안정성을 확보합니다.
- **코드 품질 향상:** 테스트 가능한 코드를 작성하도록 유도하여 코드의 모듈성과 응집도를 높입니다.
- **개발 속도 향상:** 변경 사항에 대한 확신을 가지고 빠르게 개발을 진행할 수 있습니다.
- **문서화:** 테스트 코드 자체가 로직의 동작 방식을 설명하는 좋은 문서 역할을 합니다.
