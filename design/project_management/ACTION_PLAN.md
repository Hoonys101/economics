# 프로젝트 실행 계획: "살아있는 디지털 경제" 구축

## 1. 프로젝트 청사진 (Overall Blueprint)

이 프로젝트의 최종 목표는 단순한 시뮬레이션을 넘어, **AI 에이전트들이 스스로 학습하고 적응하며 진화하는 "디지털 트윈(Digital Twin)" 경제 생태계**를 구축하는 것입니다.

### 4대 핵심 기둥 (4 Key Pillars):

1.  **견고한 경제 엔진 (Robust Economic Engine):**
    *   **설명:** 모든 경제 활동의 기반. 현실적인 상품/노동 시장, 에이전트의 생애주기(창업/폐업, 출생/사망), 신뢰할 수 있는 거시 경제 지표(GDP, 실업률, 물가)가 안정적으로 동작하는 시스템입니다.
    *   **현재 상태:** **노동 시장 활성화 완료.** 가계 소비 문제 해결이 다음 우선 과제입니다.
    *   **이전 상태:** **가장 시급한 개선 영역.** 노동 시장이 멈춰있는 등 핵심 기능의 불안정성 해소가 최우선 과제였습니다.

2.  **적응형 AI 에이전트 (Adaptive AI Agents):**
    *   **설명:** 프로젝트의 핵심 혁신. 가계와 기업이 하드코딩된 규칙이 아닌, 강화학습과 모방학습을 통해 자신만의 생존 및 성장 전략을 발전시킵니다. 성공한 다른 에이전트를 모방하고, 변화하는 시장 상황에 맞춰 의사결정을 동적으로 수정합니다.
    *   **현재 상태:** AI 모델의 기본 골격은 존재하나, 의사결정 로직과의 연동 및 학습 메커니즘의 고도화가 필요합니다.

3.  **확장 가능한 세계 모델 (Extensible World Model):**
    *   **설명:** 시뮬레이션의 세계관을 확장할 수 있는 유연한 구조. 정부(세금, 보조금), 금융 시장(대출, 투자), 기술 발전(R&D) 등 새로운 경제 주체와 시스템을 손쉽게 추가할 수 있어야 합니다.
    *   **현재 상태:** 현재는 가계/기업만 존재. 확장을 위한 기반 설계가 필요합니다.

4.  **통찰력 있는 분석 및 UI (Insightful Analytics & UI):**
    *   **설명:** 복잡한 시뮬레이션 결과를 이해하고 실험하기 위한 창구. 단순 데이터 표시를 넘어, 부의 분배(지니 계수), 산업 구조 변화 등 거시 경제 현상을 시각적으로 분석하고, 다양한 "What-if" 시나리오를 실험할 수 있는 환경을 제공합니다.
    *   **현재 상태:** 기본적인 UI 골격은 있으나, 데이터 표시 오류가 있고 분석 기능이 거의 없습니다.

---

## 2. 단계별 실행 계획 (Phased Approach)

### Phase 0: 기반 안정화 (Foundation Stabilization) - 즉시 실행

*   **목표:** 현재 멈춰있는 시뮬레이션의 핵심 기능을 정상화하여, 신뢰할 수 있는 실험의 기반을 마련합니다.
*   **주요 과업:**
    1.  **로깅 시스템 정상화:** 디버깅을 위한 로그 필터링 기능 구현 및 멀티프로세싱 오류 수정.
    2.  **노동/상품 시장 활성화:** 기업의 고용과 가계의 소비가 정상적으로 발생하는지 확인하고 관련 로직을 디버깅.
    3.  **핵심 지표 검증:** 실업률, 평균 임금, 평균 자산 등 UI에 표시되는 모든 지표의 정확성 확보.
*   **완료 조건:** 시뮬레이션이 100틱 이상 안정적으로 실행되며, 모든 핵심 경제 지표가 비정상적인 값(0 또는 100%)이 아닌 유의미한 값을 보이는 상태.

### Phase 1: AI 통합 및 고도화 (AI Integration & Refinement)

*   **목표:** AI 에이전트가 단순 반응을 넘어, 학습을 통해 지능적으로 행동하게 만듭니다.
*   **주요 과업:**
    1.  의사결정 엔진 리팩토링 (규칙 기반 vs AI 기반 로직 분리).
    2.  성공적인 에이전트를 따라하는 '모방 학습' 메커니즘 구현 및 검증.
    3.  다양한 시나리오(호황, 불황)를 통해 AI 모델을 학습시켜 다채로운 에이전트 행동 패턴 확보.

### Phase 2: 세계 확장 (World Expansion)

*   **목표:** 정부, 금융 등 새로운 시스템을 도입하여 경제 생태계를 더욱 현실적으로 만듭니다.
*   **주요 과업:**
    1.  `정부` 에이전트 도입 (세금 징수, 실업 수당 지급 기능).
    2.  기본적인 `금융 시장` 구현 (에이전트 간 대출 기능).
    3.  기업의 `R&D` 활동과 생산성 향상 모델 구현.

---

## 3. TODO 리스트 (Actionable TODO List) - Phase 0

가장 시급한 **Phase 0**를 완수하기 위한 구체적인 작업 목록입니다.

-   [x] **1. (버그) 로깅 시스템 수정:**
    -   **위치:** `utils/logger.py`
    -   **내용:** `__setstate__` 메서드를 수정하여 멀티프로세싱 환경에서 발생하는 핸들러 중복 문제를 해결한다.

-   [x] **2. (기능) 설정 기반 로그 필터링 구현:**
    -   **위치:** `utils/logger.py`, `config.py`, `run_experiment.py`
    -   **내용:**
        -   `logger.py`: 로그 타입을 외부 리스트로 설정하는 `set_allowed_log_types()` 메서드 추가.
        -   `config.py`: 허용할 로그 목록을 정의하는 `ALLOWED_LOG_TYPES` 리스트 변수 추가.
        -   `run_experiment.py` (또는 main): 시작 시 `config.py` 설정을 로거에 적용하는 로직 추가.

-   [x] **3. (버그) 노동 시장 활성화:**
    -   **위치:** `firm_decision_engine.py`, `simulation/markets_v2.py`
    -   **내용:** 수정된 로거를 사용하여 `HiringCheck`, `OrderPlacement` 등의 로그가 정상적으로 생성되는지 확인하고, 기업의 구인 주문이 시장에 제출되는 과정을 추적하여 막혀있는 부분을 해결한다.

-   [x] **4. (검증) 핵심 지표 확인:**
    -   **위치:** `analyze_results.py`, `app.py`
    -   **내용:** 노동 시장 활성화 후, 시뮬레이션을 실행하여 `unemployment_rate`와 `avg_wage`가 유의미한 값을 갖는지 최종 확인한다. **확인 결과: 노동 시장은 활성화되었으나, 가계의 소비 활동이 전혀 이루어지지 않아 자산이 감소하고 있습니다. 이는 다음 해결 과제입니다.**

-   [x] **5. (문서) 기획 문서 업데이트:**
    -   **위치:** `design/ACTION_PLAN.md`
    -   **내용:** 현재 논의된 청사진과 TODO 목록을 문서에 정리하여 팀의 목표를 동기화한다.

-   [ ] **6. (버그) 가계 소비 문제 해결:**
    -   **문제 정의:** 현재 시뮬레이션에서 가계 에이전트의 소비 활동이 전혀 이루어지지 않아, 가계 자산이 지속적으로 감소하고 있습니다. 이는 경제 시뮬레이션의 핵심 요소인 수요-공급 메커니즘이 정상적으로 작동하지 않음을 의미하며, 시뮬레이션의 현실성과 유효성을 저해합니다. `analyze_results.py` 분석 결과, `total_consumption` 및 `total_food_consumption` 지표가 0으로 나타났습니다.
    -   **위치:** `simulation/agents.py`, `simulation/decisions/household_decision_engine.py`
    -   **내용:** 가계가 재화를 구매하고 소비하지 않는 문제를 해결합니다. 가계의 욕구(특히 생존 욕구)와 자산, 시장 가격 등을 고려하여 합리적인 소비 의사결정을 내리도록 로직을 개선합니다.
    -   **가능한 해결안 제안:**
        1.  **욕구 기반 소비 우선순위:** 가계의 `survival_need`가 특정 임계치 이상일 경우, 다른 모든 행동보다 식량 구매 및 소비를 최우선으로 하도록 `HouseholdDecisionEngine`의 로직을 강화합니다.
        2.  **예산 할당 로직 개선:** 가계가 현재 자산과 예상 수입(임금)을 기반으로 소비 예산을 합리적으로 책정하고, 이를 바탕으로 구매 주문을 생성하도록 합니다.
        3.  **시장 가격 민감도:** 가계가 시장의 재화 가격 변화에 더 민감하게 반응하여, 가격이 낮을 때 구매를 늘리거나 필요에 따라 비축 구매를 고려하도록 합니다.
        4.  **AI 의사결정 모델 검토:** 가계의 AI 의사결정 모델(`ai_model_wealth_and_needs.pkl` 등)이 소비 행동을 올바르게 학습하고 있는지 확인하고, 필요시 보상 함수나 훈련 데이터를 조정합니다.
    -   **추가적인 해결안 모색의 필요성:** 위에 제안된 해결안들은 가계 소비 문제를 해결하기 위한 초기 접근 방식입니다. 실제 경제 시스템은 훨씬 복잡하므로, 시뮬레이션의 안정성과 현실성을 높이기 위해 다음과 같은 추가적인 해결안 모색이 필요할 수 있습니다.
        *   **유동성 제약:** 가계가 충분한 자산을 가지고 있더라도, 즉시 현금화할 수 있는 유동성이 부족하여 소비를 못하는 경우가 있는지 확인하고 반영합니다.
        *   **정보 비대칭:** 가계가 시장의 모든 정보를 완벽하게 알지 못한다는 가정을 도입하여, 정보 탐색 비용이나 지연을 고려한 소비 로직을 추가합니다.
        *   **사회적 영향:** 다른 가계의 소비 패턴이나 사회적 지위가 가계의 소비 결정에 미치는 영향을 모델링합니다.
        *   **디버깅 도구 강화:** 가계의 의사결정 과정을 시각적으로 추적할 수 있는 디버깅 도구를 추가하여, 소비가 이루어지지 않는 정확한 원인을 파악하는 데 도움을 받습니다.
