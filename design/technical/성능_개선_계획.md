# 성능 개선 계획 (Performance Improvement Plan)

## 1. 웹 UI 성능 병목 현상 해결

### 1.1. 현상 분석 및 원인 파악
- **현상:** 웹 UI에서 시뮬레이션이 매우 느리게 동작합니다.
- **조치:** `cProfile`과 같은 Python 프로파일러를 사용하여 `app.py`의 `run_simulation_loop` 함수와 `get_simulation_state` 함수 중 어느 부분에서 시간이 가장 많이 소요되는지 정확히 파악해야 합니다.

### 1.2. 개선 방안 (프로파일링 결과에 따라 적용)
- `time.sleep()`이 문제의 원인이 아닐 가능성이 높습니다. 프로파일링 결과에 따라 다음을 고려합니다:
    - **데이터 집계 로직 최적화:** 시뮬레이션 데이터를 집계하고 UI에 전달하는 과정에서 비효율적인 부분이 있는지 확인하고 최적화합니다.
    - **락(lock) 경합 최소화:** 멀티스레딩/멀티프로세싱 환경에서 락(lock)으로 인한 병목 현상이 발생하는지 확인하고, 락의 범위를 최소화하거나 비동기 처리 방식을 고려합니다.
    - **UI 업데이트 빈도 조절:** 너무 잦은 UI 업데이트 호출이 부하를 유발할 수 있습니다. `index.html`의 `setInterval` 주기를 1초 이상으로 늘려 UI 업데이트 부하를 줄이는 것을 즉각적인 해결책으로 적용할 수 있습니다.

## 2. 로그 볼륨 감소를 통한 성능 기여

- **현상:** 과도한 로그 메시지 생성으로 인해 파일 I/O 부하가 발생하고 시뮬레이션 성능에 영향을 줄 수 있습니다.
- **조치:** `utils/logger.py`에 샘플링 로직을 도입하여 특정 `method_name`을 가진 로그 메시지의 기록 빈도를 조절합니다.
    - **대상 로그:** `AIDecision`, `ProduceDebug`, `FoodConsumptionCalc`, `FoodConsumptionControlled`, `FoodConsumptionSkipped`
    - **샘플링 비율:** 초기 0.1 (10%만 기록)로 설정하여 로그 볼륨을 90% 감소시킵니다.
    - **구현:** `Logger.set_sampling_rate(method_name, rate)` 메서드를 통해 각 로그 유형의 샘플링 비율을 설정합니다.
