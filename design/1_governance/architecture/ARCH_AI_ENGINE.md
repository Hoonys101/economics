# Architecture Detail: AI Engine & Intelligence Layer

## 1. 개요
본 시뮬레이션의 지능 계층은 에이전트들이 변화하는 시장 환경에 적응하고 최적의 전략을 수립할 수 있도록 돕습니다. 초기 하드코딩된 규칙 대신, 데이터 기반의 학습 및 최적화 엔진을 사용하여 경제 시스템의 창발적(Emergent) 현상을 유도합니다.

## 2. 강화학습 아키텍처 (Q-Learning)

### 2.1 Multi-Channel Aggressiveness Vector
- 에이전트의 행위를 단순히 한 가지 차원이 아닌, 소비(Consumption), 투자(Investment), 노동(Labor) 등 여러 채널에 대한 "적극성 지수(Aggressiveness)"로 벡터화하여 관리합니다.
- AI 엔진은 이 벡터의 각 채널에 가중치를 부여하여 전략을 생성합니다.

### 2.2 AITrainingManager
- **전략의 복제와 변이**: 주기적으로 성과가 우수한 에이전트의 Q-Table을 다른 에이전트에게 전파하거나, 무작위 변이를 통해 새로운 전략을 탐색(Exploration)합니다.
- **오프라인 학습**: 시뮬레이션 종료 후 수집된 데이터를 바탕으로 모델을 튜닝하여 점진적으로 시스템의 지능을 높입니다.

## 3. 연산 최적화 (Optimization Layer)

대규모 에이전트(2,000명 이상)의 지능적 연산을 실시간으로 처리하기 위해 최적화 계층을 운영합니다.

### 3.1 Vectorized Planner (with NumPy)
- 개별 에이전트 루프를 도는 대신, `numpy` 배열 연산을 활용하여 수천 명의 의사결정을 한 번에 병렬적으로 계산합니다.
- **성능**: 하드웨어 가속을 통해 틱당 연산 시간을 밀리초 단위로 단축합니다.

### 3.2 Data-Driven Purity
- **DecisionContext**: 의사결정에 필요한 모든 정적 데이터(State, Market Data, Config)를 집계한 불변 컨텍스트 객체.
- AI 엔진은 이 컨텍스트 외의 어떤 외부 시스템에도 의존하지 않으며, 동일 입력에 대해 동일한 전략을 산출합니다.

## 4. 지능적 진화 (Evolutionary Mechanism)
시스템은 고정된 상태에 머물지 않고 끊임없이 진화합니다.
1. **Agent Dynamics**: 유능한 에이전트는 살아남아 자산을 축적하고, 무능한 에이전트는 파산하여 사라집니다.
2. **Strategy Gene Pool**: 우수 에이전트의 Q-Table은 "전략 자산"으로 관리되어 다음 세대로 전수됩니다.

## 5. 아키텍처적 의의
AI 엔진은 시뮬레이션에 "생명력"을 불어넣는 역할을 합니다. 단순한 수식의 나열이 아니라, 에이전트들이 스스로 이익을 추구하는 과정에서 인플레이션, 스태그플레이션, 호황과 불황 같은 복잡한 거시경제 현상이 자연스럽게 발생하게 됩니다.
