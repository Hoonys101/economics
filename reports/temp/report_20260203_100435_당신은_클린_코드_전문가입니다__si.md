# 클린 코드 감사: 하드코딩된 상수 장부

## Executive Summary

코드베이스 전반에 걸쳐 하드코딩된 다수의 숫자, 문자열, 및 비즈니스 로직 임계값들이 식별되었습니다. 이러한 값들은 시뮬레이션의 유연성과 유지보수성을 저해할 수 있습니다. 본 문서는 식별된 상수들을 중앙 설정 파일(`config.py` 또는 `economy_params.yaml`)로 외부화하여 코드의 가독성을 높이고, 파라미터 튜닝을 용이하게 하며, 잠재적 버그를 줄이는 것을 목표로 합니다. 각 상수에 대해 제안된 변수명, 설명, 그리고 권장 위치를 명시하였습니다.

## Detailed Analysis

| 파일 | 라인 | 값 | 변수명 (제안) | 설명 | 권장 위치 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Bank & Finance** | | | | | |
| `simulation/bank.py` | 23 | `100` | `TICKS_PER_YEAR` | 1년을 구성하는 틱의 수. 이자율 계산의 기준이 됨. | `simulation.yaml` |
| `simulation/bank.py` | 24 | `0.05` | `INITIAL_BASE_ANNUAL_RATE` | 초기 기준 연간 이자율. | `economy_params.yaml` |
| `simulation/bank.py` | 179 | `50` | `DEFAULT_LOAN_TERM_TICKS` | 대출의 기본 만기 기간 (틱 단위). | `economy_params.yaml` |
| `simulation/bank.py` | 314 | `0.02` | `BANK_DEPOSIT_MARGIN` | 은행의 예대마진. | `economy_params.yaml` |
| `simulation/bank.py` | 315 | `0.02` | `BANK_CREDIT_SPREAD_BASE` | 기본 신용 가산 금리. | `economy_params.yaml` |
| `simulation/bank.py` | 511 | `100` | `CREDIT_RECOVERY_TICKS` | 파산 후 신용 회복에 걸리는 시간 (틱 단위). | `economy_params.yaml` |
| `simulation/bank.py` | 515 | `0.2` | `BANKRUPTCY_XP_PENALTY` | 파산 시 교육 경험치(XP) 감소 비율. | `economy_params.yaml` |
| `simulation/bank.py` | 496 | `1000.0` | `BANK_SOLVENCY_BUFFER` | 은행이 지급 불능 상태일 때 정부로부터 빌리는 최소 금액. | `economy_params.yaml` |
| `simulation/loan_market.py` | 91 | `0.05` | `DEFAULT_MORTGAGE_INTEREST_RATE` | 모기지 대출 기본 이자율. | `economy_params.yaml` |
| **Agent Behavior & AI** | | | | | |
| `simulation/core_agents.py` | 108 | `(20.0, 60.0)` | `INITIAL_HOUSEHOLD_AGE_RANGE` | 가계 에이전트의 초기 나이 범위. | `economy_params.yaml` |
| `simulation/core_agents.py` | 141 | `(0.5, 0.15)` | `INITIAL_APTITUDE_DISTRIBUTION` | 가계의 초기 적성(학습 잠재력) 정규분포 (평균, 표준편차). | `economy_params.yaml` |
| `simulation/core_agents.py` | 272 | `0.8` | `EMERGENCY_LIQUIDATION_PRICE_DISCOUNT` | 긴급 유동화 시 자산 판매 할인율. | `economy_params.yaml` |
| `simulation/core_agents.py` | 286 | `8.0` | `EMERGENCY_STOCK_LIQUIDATION_FALLBACK_PRICE` | 긴급 주식 매각 시 시장 데이터가 없을 때의 대체 가격. | `economy_params.yaml` |
| `simulation/core_agents.py` | 830 | `5` | `DISTRESS_GRACE_PERIOD_TICKS` | 에이전트가 재정적 곤경에 처했을 때 파산을 유예하는 기간. | `economy_params.yaml` |
| `simulation/ai/action_selector.py`| 18-20 | `(0.5, 0.05, 700)` | `AI_EPSILON_DECAY_PARAMS` | AI 탐험율(epsilon) 감소 파라미터 (초기값, 최종값, 감소기간). | `economy_params.yaml` |
| `simulation/ai/firm_ai.py` | 21 | `[0.0, ..., 1.0]` | `AI_FIRMAI_AGGRESSIVENESS_LEVELS` | 기업 AI가 선택할 수 있는 이산적인 행동 적극성 단계. | `economy_params.yaml` |
| `simulation/ai/firm_ai.py` | 55-69 | `[...]` | `AI_FIRMAI_STATE_DISCRETIZATION_BINS` | 기업 AI의 상태 공간을 이산화하기 위한 구간 값들. | `economy_params.yaml` |
| `simulation/ai/firm_ai.py` | 196 | `0.05` | `AI_REWARD_BRAND_VALUE_MULTIPLIER` | 보상 함수에서 브랜드 인지도 변화가 자산 가치에 미치는 영향 계수. | `economy_params.yaml` |
| `simulation/ai/firm_system2_planner.py` | 26 | `1.1` | `AUTOMATION_INVESTMENT_HURDLE_RATE` | 자동화 투자를 결정하기 위한 최소 NPV 상승률. | `economy_params.yaml` |
| `simulation/ai/firm_system2_planner.py` | 134 | `0.01` | `SYSTEM2_NPV_DEFAULT_GROWTH_RATE` | System2 플래너가 미래 현금 흐름 예측 시 사용하는 기본 성장률. | `economy_params.yaml` |
| `simulation/ai/government_ai.py`| 83 | `0.60` | `GOV_AI_TARGET_DEBT_RATIO` | 정부 AI가 목표로 하는 GDP 대비 부채 비율. | `economy_params.yaml` |
| `simulation/ai/government_ai.py`| 87-99 | `(-0.01, 0.01)` | `GOV_AI_STATE_DISCRETIZATION_BINS` | 정부 AI의 거시경제 상태(인플레이션, 실업률 등) 이산화 임계값. | `economy_params.yaml` |
| `simulation/ai/government_ai.py`| 116 | `(0.5, 0.4, 0.1)` | `GOV_AI_REWARD_FUNCTION_WEIGHTS` | 정부 AI 보상 함수에서 인플레이션, 실업, 부채 갭의 가중치. | `economy_params.yaml` |
| `simulation/ai/government_ai.py`| 117 | `100.0` | `GOV_AI_REWARD_SCALING_FACTOR` | 정부 AI 보상 함수의 최종 결과에 곱해지는 스케일링 팩터. | `economy_params.yaml` |
| `simulation/ai/household_ai.py` | 44-52 | `[...]` | `AI_HOUSEHOLDAI_STATE_DISCRETIZATION_BINS` | 가계 AI의 상태 공간(자산, 욕구 등)을 이산화하기 위한 구간 값들. | `economy_params.yaml` |
| `simulation/ai/household_system2.py`| 28-29 | `10`, `120` | `HOUSING_NPV_HORIZON_YEARS` | 주택 구매 NPV 계산 시 사용되는 예측 기간 (년). | `simulation.yaml` |
| `simulation/ai/household_system2.py`| 32 | `0.02` | `HOUSING_NPV_RISK_PREMIUM` | 주택 구매 NPV 계산 시 할인율에 더해지는 위험 프리미엄. | `economy_params.yaml` |
| `simulation/ai/household_system2.py`| 36 | `0.01` | `HOUSING_ANNUAL_MAINTENANCE_RATE` | 주택 연간 유지보수 비용 비율 (주택 가격 대비). | `economy_params.yaml` |
| `simulation/ai/household_system2.py`| 40 | `0.2` | `MORTGAGE_DEFAULT_DOWN_PAYMENT_RATE` | 모기지 대출 시 기본 계약금 비율. | `economy_params.yaml` |
| `simulation/ai/model_wrapper.py` | 27 | `[...]` | `AI_MODEL_FEATURE_LIST` | AI 모델의 특징(feature)으로 사용될 아이템 ID 목록. `goods.json`에서 동적으로 생성해야 함. | `config.py` |
| **System & Policy** | | | | | |
| `simulation/systems/bootstrapper.py` | 13-16 | `...` | `BOOTSTRAP_PARAMS` | 초기화 관련 파라미터 (최소자본, 초기재고, 강제할당인원, 기본임금). | `config.py` |
| `simulation/systems/housing_system.py` | 64 | `0.8` | `FORECLOSURE_FIRE_SALE_DISCOUNT` | 압류된 부동산 긴급 매각 시의 할인율. | `economy_params.yaml` |
| `simulation/systems/ma_manager.py`| 83 | `1.1` | `FRIENDLY_MERGER_PREMIUM` | 우호적 M&A 시 제안 가격에 붙는 프리미엄. | `economy_params.yaml` |
| `simulation/systems/ma_manager.py`| 104 | `1.2` | `HOSTILE_TAKEOVER_PREMIUM` | 적대적 M&A 시 제안 가격에 붙는 프리미엄. | `economy_params.yaml` |
| `simulation/systems/ma_manager.py`| 107 | `0.6` | `HOSTILE_TAKEOVER_SUCCESS_PROB` | 적대적 M&A 성공 기본 확률. | `economy_params.yaml` |
| `simulation/systems/ma_manager.py`| 131 | `0.3`, `0.5` | `MERGER_EMPLOYEE_RETENTION_RATES` | M&A 이후 피인수 기업 직원 유지 비율 (적대적/우호적). | `economy_params.yaml` |
| `simulation/policies/smart_leviathan_policy.py`| 28-30 | `(0.01, 0.0025, 0.1)` | `POLICY_ACTUATOR_STEP_SIZES` | AI 정책 실행 시 세율, 금리, 예산의 변경 단계 크기. | `economy_params.yaml` |
| `simulation/policies/smart_leviathan_policy.py`| 67-69 | `[...]` | `POLICY_ACTUATOR_BOUNDS` | 정책 변수(금리, 세율 등)의 안전 한계값 (최소/최대). | `economy_params.yaml` |
| **Miscellaneous** | | | | | |
| `simulation/components/demographics_component.py`| 77-83 | `{...}` | `AGE_DEATH_PROBABILITIES` | 연령대별 연간 사망 확률. | `economy_params.yaml` |
| `simulation/components/hr_department.py`| 33 | `10.0` | `FALLBACK_SURVIVAL_COST` | 생존 비용 계산 실패 시 사용되는 대체값. | `economy_params.yaml` |
| `simulation/components/labor_manager.py`| 48 | `1.0` | `BASE_LABOR_SKILL` | 신규 노동력의 기본 노동 기술 수준. | `economy_params.yaml` |
| `simulation/markets/order_book_market.py`| 42 | `20` | `PRICE_VOLATILITY_WINDOW_TICKS` | 가격 변동성 계산 시 사용되는 가격 이력의 크기. | `simulation.yaml` |
| `simulation/markets/stock_market.py`| 152 | `0.10` | `STOCK_PRICE_LIMIT_RATE` | 주식 시장의 일일 가격 변동폭 제한. | `economy_params.yaml` |

## Conclusion

코드베이스 전반에 걸쳐 설정 가능한 값들이 하드코딩되어 있어, 이를 외부 설정 파일로 분리하는 작업이 시급합니다. 본 장부에 명시된 제안에 따라 상수들을 `config.py`와 `economy_params.yaml`로 이전하면, 시뮬레이션의 다양한 시나리오 테스트와 파라미터 튜닝이 훨씬 용이해질 것입니다. 이 작업은 코드의 유지보수성을 향상시키고, "Magic Number"로 인한 잠재적 오류를 예방하는 데 결정적인 역할을 할 것입니다.I've completed the audit of the provided code for hardcoded constants.

I will now generate the ledger of these constants, detailing their location, suggested variable names, descriptions, and recommended placement in either `config.py` for global simulation settings or `economy_params.yaml` for specific economic and behavioral parameters.

# Report: Hardcoded Constants Audit

## Executive Summary
An audit of the simulation codebase revealed numerous hardcoded constants impacting economic behavior, agent decisions, and system-level rules. To enhance configurability, maintainability, and clarity, these values should be externalized. This report provides a comprehensive ledger of identified constants, with recommendations for migrating them to `config.py` for structural parameters or `economy_params.yaml` for tunable economic variables. This refactoring will enable easier scenario management and more robust simulation tuning.

## Constants Ledger

| File | Line | Value | Suggested Variable Name | Description | Recommended Location |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Bank & Finance** |
| `simulation/bank.py` | 23 | `100` | `TICKS_PER_YEAR` | Defines the number of ticks that constitute one year for interest calculations. | `simulation.yaml` |
| `simulation/bank.py` | 24 | `0.05` | `INITIAL_BASE_ANNUAL_RATE` | The starting annual base interest rate for the banking system. | `economy_params.yaml` |
| `simulation/bank.py` | 179 | `50` | `DEFAULT_LOAN_TERM_TICKS` | The default duration of a loan in ticks if not otherwise specified. | `economy_params.yaml` |
| `simulation/bank.py` | 314-315 | `0.02` | `BANK_MARGIN`, `CREDIT_SPREAD_BASE` | The margin and credit spread used by the bank for setting deposit and loan rates. | `economy_params.yaml` |
| `simulation/bank.py` | 511 | `100` | `CREDIT_RECOVERY_TICKS` | The duration an agent's credit is frozen after defaulting on a loan. | `economy_params.yaml` |
| `simulation/bank.py` | 515 | `0.2` | `BANKRUPTCY_XP_PENALTY` | The percentage of education XP lost by a household upon bankruptcy. | `economy_params.yaml` |
| `simulation/bank.py` | 496 | `1000.0` | `BANK_SOLVENCY_BUFFER` | The buffer amount a bank borrows if it becomes insolvent. | `economy_params.yaml` |
| **Agent Behavior & AI** |
| `simulation/core_agents.py` | 108 | `(20.0, 60.0)` | `INITIAL_HOUSEHOLD_AGE_RANGE` | The min/max range for randomly assigning initial age to households. | `economy_params.yaml` |
| `simulation/core_agents.py` | 272 | `0.8` | `EMERGENCY_LIQUIDATION_DISCOUNT` | Price discount factor applied during emergency asset liquidation. | `economy_params.yaml` |
| `simulation/core_agents.py` | 830 | `5` | `DISTRESS_GRACE_PERIOD_TICKS` | Number of ticks an agent can be in distress before facing consequences. | `economy_params.yaml` |
| `simulation/ai/action_selector.py`| 18-20 | `(0.5, 0.05, 700)` | `AI_EPSILON_DECAY_PARAMS` | Parameters (initial, final, steps) for AI's epsilon-greedy exploration decay. | `economy_params.yaml` |
| `simulation/ai/firm_ai.py` | 55-69 | `[...]` | `AI_FIRM_STATE_BINS` | A dictionary of lists defining the bins for discretizing a firm's state for the AI. | `economy_params.yaml` |
| `simulation/ai/household_system2.py`| 28 | `10` | `HOUSING_NPV_HORIZON_YEARS` | The number of years to project for housing net present value calculations. | `economy_params.yaml` |
| `simulation/ai/household_system2.py`| 32 | `0.02` | `HOUSING_NPV_RISK_PREMIUM` | The risk premium added to the discount rate for housing NPV calculations. | `economy_params.yaml` |
| `simulation/ai/household_system2.py`| 40 | `0.2` | `MORTGAGE_DEFAULT_DOWN_PAYMENT_RATE` | The default down payment percentage required for a mortgage. | `economy_params.yaml` |
| `simulation/ai/model_wrapper.py` | 27 | `[...]` | `AI_MODEL_FEATURE_LIST` | Hardcoded list of item IDs used for AI model features. Should be dynamically generated. | `config.py` |
| **System & Policy** |
| `simulation/systems/bootstrapper.py` | 13-16 | `...` | `BOOTSTRAP_PARAMS` | A dictionary containing all bootstrapping parameters. | `config.py` |
| `simulation/systems/housing_system.py` | 64 | `0.8` | `FORECLOSURE_FIRE_SALE_DISCOUNT` | Discount for foreclosed properties sold by the bank. | `economy_params.yaml` |
| `simulation/systems/ma_manager.py` | 104, 107 | `1.2`, `0.6` | `HOSTILE_TAKEOVER_PREMIUM`, `HOSTILE_TAKEOVER_SUCCESS_PROB`| The premium offered and base success probability for a hostile takeover. | `economy_params.yaml` |
| `simulation/policies/smart_leviathan_policy.py`| 28-30 | `(0.01, ...)` | `POLICY_ACTUATOR_STEP_SIZES` | A dictionary defining the incremental change size for different policy tools. | `economy_params.yaml` |
| `simulation/policies/smart_leviathan_policy.py`| 67-69 | `[...]` | `POLICY_ACTUATOR_BOUNDS` | A dictionary defining the min/max safety bounds for policy variables. | `economy_params.yaml` |
| **Miscellaneous** |
| `simulation/components/agent_lifecycle.py` | 19 | `8.0` | `DEFAULT_WORK_HOURS_PER_TICK` | The standard number of hours an employed agent works per tick. | `economy_params.yaml` |
| `simulation/components/demographics_component.py`| 77-83 | `{...}` | `AGE_DEATH_PROBABILITIES` | A dictionary mapping age thresholds to annual death probabilities. | `economy_params.yaml` |
| `simulation/components/labor_manager.py`| 48 | `1.0` | `BASE_LABOR_SKILL` | The starting labor skill level for new agents. | `economy_params.yaml` |
| `simulation/markets/order_book_market.py`| 42 | `20` | `PRICE_VOLATILITY_WINDOW_TICKS` | The number of recent trades to consider for calculating price volatility. | `simulation.yaml` |

## Conclusion
This audit has identified critical areas where hardcoded values can be replaced with configurable parameters. By moving these constants to `config.py` and `economy_params.yaml`, the simulation will become significantly more modular, easier to maintain, and more powerful for experimental analysis. It is strongly recommended to undertake this refactoring task to improve the overall quality and longevity of the codebase.
